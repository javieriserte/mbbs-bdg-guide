\documentclass[a4paper, twoside]{article}%
%Options -- Point size:  10pt (default), 11pt, 12pt
%        -- Paper size:  letterpaper (default), a4paper, a5paper, b5paper
%                        legalpaper, executivepaper
%        -- Orientation  (portrait is the default)
%                        landscape
%        -- Print size:  oneside (default), twoside
%        -- Quality      final(default), draft
%        -- Title page   notitlepage, titlepage(default)
%        -- Columns      onecolumn(default), twocolumn
%        -- Equation numbering (equation numbers on the right is the default)
%                        leqno
%        -- Displayed equations (centered is the default)
%                        fleqn (equations start at the same distance from the right side)
%        -- Open bibliography style (closed is the default)
%                        openbib
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Lista de Paquetes
\usepackage{pifont}             % Maneja Fuentes 
%\usepackage{PTSans}            % Maneja Fuentes Sans Serif
%\usepackage{skak}              % simbolos de ajedrez
\usepackage[T1]{fontenc}        % Texto de alta calidad en pdfs
\usepackage{ae,aecompl}         % Texto de alta calidad en pdfs
\usepackage{pslatex}            % Texto de alta calidad en pdfs
\usepackage{textcomp}           % Cosas de Texto
\usepackage{multicol}           % Para manejar multiples columnas
\usepackage[ansinew]{inputenc}  % Para poner acentos
\usepackage[spanish,es-tabla]{babel}     % Para separar palabras al fin de los
% renglones.
\usepackage{amsmath}            % Para hacer matemática
\usepackage{amsfonts}           % Para hacer matemática
\usepackage{amssymb}            % Para hacer matemática
\usepackage{enumerate}          % Para Manehar Enumeraciones
\usepackage{vwcol}              % para manejar multiples columas
\usepackage{graphicx}           % Para manejar los grÃ¡ficos
\usepackage{fancyhdr}           % Para manejar encabezados y pie de pÃ¡ginas
\usepackage{lastpage}           % Crea una referencia a la Ãºltima pÃ¡gina. Util
                                % para numerar pÃ¡ginas de la forma "pÃ¡gina x de y"
%\usepackage[final]{ps4pdf}     % para incluir archivos eps dentro del documento pdf
\usepackage{array}
\usepackage{soul}
\usepackage{boolexpr}
\usepackage[hyphens]{url}   % Typeset urls
\usepackage[pdfborder={0 0 0 [3 3]}]{hyperref}       % Hipervísnculos en las url
\usepackage{colortbl}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Configuración de página
\textwidth 15cm               
\textheight 25.7cm            
\oddsidemargin 1cm           
\evensidemargin 0cm          
\topmargin -1.5cm             
\headheight 0cm               
\headsep 10pt                 
\marginparwidth 0cm
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BibliografÃ­a
\bibliographystyle{alpha}      
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Titulo
\newcommand{\s}{\the\textwidth}
\newcommand{\materiaName}{Bases de datos genomicas}
\newcommand{\seminarioName}{Guia de trabajos practicos}
\newcommand{\fecha}{Julio de 2015}
\newcommand{\titulo}{
  \begin{center}
  \vspace*{-22pt}\large\textbf{\materiaName}\\
  \vspace{2pt}\normalsize{\seminarioName}\\
  \vspace{2pt}\small{Maestría en bioinformática y biología de sistemas}\\
  \vspace{-6pt}\rule{\textwidth}{0.4pt}
  \end{center}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Encabezado y Pie de PÃ¡gina
 \headheight=14pt
 \renewcommand{\headrulewidth}{0.4pt}                                 
 \renewcommand{\footrulewidth}{0.4pt}                                 
 \pagestyle{fancy}                                                   
 \fancyfoot{}
 \lfoot{\footnotesize{Página \thepage\ de \pageref{LastPage}}}        
 \lhead{\footnotesize{\materiaName}}
 \rhead{\footnotesize{\fecha\  - \seminarioName}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fuentes
%\renewcommand{\familydefault}{\sfdefault} % Cambia todas las fuentes a sans 
                                           % Serif
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                                 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Enumeraciones
\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{\textbf{\theenumi}}
\renewcommand{\theenumii}{\arabic{enumii}}
\renewcommand{\labelenumii}{\theenumii}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fin del preludio
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\titulo

\section{Conceptos generales}
\subsection{Formatos de archivo}
\subsubsection{Fasta}
\subsubsection{Texto plano}
\subsubsection{Tabular}
\subsubsection{XML y similares}

\subsection{Acceso programático}
\subsubsection{Acceso REST}
\subsubsection{Programas}
\subsubsection{Lenguages de programación}

\section{Bases de datos primarias de nucleótidos}

\newpage
\subsection{National Center of Biotechnology Information - NCBI}
El NCBI ofrece un conjunto de herramientas para el acceso programático a sus 
bases de datos que se llama NCBI E-utilities y se basa en una interface REST.
Se puede accede a ellas con el sistema Entrez (\textit{Global Query 
Cross-Database Search System}). 
Cada una de estas herramientas, tiene una URL base particular y está destindada
a ofrecer diferentes funciones. Es importante mencionar que Entrez, no solo ofrece acceso a
base de datos de secuencias, sino de otro tipo, como por ejemplo bibliográfico, a 
través de \emph{Pubmed}. Los servicios de Entrez que se discutirán son EInfo, 
ESearch, ESummary y EFetch. Estos no son los únicos servicios disponibles, pero
son los más relevantes.

\subsubsection{Formato del registro}
El formato de texto plano de NCBI tiene tres secciones principales. El 
encabezado (Desde \emph{LOCUS} hasta \emph{JOURNAL}), una tabla de 
características anotadas en la secuencia (\emph{FEATURES}) y la secuencia 
propiamente (\emph{ORIGIN}). A continuación se muestra, como ejemplo, un 
registro en este formato.  
\begin{verbatim}
LOCUS       AJ131281                 348 bp    RNA     linear   VRL 10-DEC-1999
DEFINITION  Lymphocytic choriomeningitis virus z gene, partial, strain MX.
ACCESSION   AJ131281
VERSION     AJ131281.1  GI:3970751
KEYWORDS    RING finger protein; z gene.
SOURCE      Lymphocytic choriomeningitis mammarenavirus (LCMV)
  ORGANISM  Lymphocytic choriomeningitis mammarenavirus
            Viruses; ssRNA viruses; ssRNA negative-strand viruses;
            Arenaviridae; Mammarenavirus.
REFERENCE   1
  AUTHORS   Gibadulinova,A., Zelnik,V., Reiserova,L., Zavodska,E.,
            Zatovicova,M., Ciampor,F., Pastorekova,S. and Pastorek,J.
  TITLE     Sequence and characterisation of the Z gene encoding ring finger
            protein of the lymphocytic choriomeningitis virus MX strain
  JOURNAL   Acta Virol. 42 (6), 369-374 (1998)
   PUBMED   10358742
REFERENCE   2  (bases 1 to 348)
  AUTHORS   Pastorek,J.
  TITLE     Direct Submission
  JOURNAL   Submitted (02-DEC-1998) Pastorek J., Molecular Biology, Institute
            of Virology, Slovak Academy of Sciences, Dubravska cesta 9, 842 46,
            SLOVAK REPUBLIC
FEATURES             Location/Qualifiers
     source          1..348
                     /organism="Lymphocytic choriomeningitis mammarenavirus"
                     /mol_type="genomic RNA"
                     /strain="MX"
                     /db_xref="taxon:11623"
                     /lab_host="HeLa cells"
     gene            <70..343
                     /gene="z"
     CDS             <70..343
                     /gene="z"
                     /experiment="experimental evidence, no additional details
                     recorded"
                     /codon_start=2
                     /product="ring finger protein"
                     /protein_id="CAA10342.1"
                     /db_xref="UniProtKB/TrEMBL:Q9YJW6"
                     /translation="MGQGKSKEKKDTNTGDRAEILPDTTYLGPLNCKSCWQKFDSLVR
                     CHDHYLCRHCLNLLLSVSDRCPLCKCPLPTKLKISTAPSPPPPYEE"
     mat_peptide     <70..338
                     /gene="z"
                     /product="ring finger protein"
ORIGIN      
        1 cgtttagttg cgctgtttgg ttgaacagcc ttttcctgtg agagtacaga gacaaaccta ...
//

\end{verbatim}
 
\subsubsection{EInfo}
La URL base de este servicio es `\url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/einfo.fcgi}'.
Su función es simplemente dar los nombres y estadísticas acerca de las bases de 
datos disponibles. Si se consulta esta base de datos sin ningún parámetro 
devuelve un listado de los nombres de las bases de datos disponibles en el 
sistema. 

El parámetro \emph{db} permite especficar una base de datos particular y obtener
información sobre ella. El formato de respuesta es por omisión XML, pero puede
ser modificado con el parámetro \emph{retmode}. Este parámetro tiene dos valores
posibles, `XML' y `json'. Adicionalmente, se puede usar el parámetro \emph{version}
que solo acepta un valor `2.0', para especificar que los datos se recuperen en
la versión 2.0 Einfo XML. La diferencia entre la versión por omisión y la 2.0 
es el agregado de dos términos, `IsTruncatable' y `IsRangeable', en los 
la descripción de los campos de los registros de la base de datos.

Ejemplo:
\begin{itemize}
  \item \url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/einfo.fcgi?db=protein&version=2.0} \\
  Recupera información sobre la base de datos \emph{protein} en la versión 2.0.
\end{itemize}

\subsubsection{ESearch}
La URL base de este servicio es \url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi}.
Permite la búsqueda por texto en las bases de datos, como resultado devuelve
una lista de número de identificación de cada registro. 

Este servicio requiere que especificar la base de datos en la cual buscar, para 
ello se utiliza el parámetro \emph{db}. 

Además, se requiere del parámetro 
\emph{term} para detallar el texto que se desea buscar. La búsqueda por texto,
recupera registros que coinciden con el texto ingresado en cualquier campo.
Sin embargo, es posible ser más específico, y restringir la búsqueda a un 
campo en particular. Para ello, luego del término de búsqueda se adiciona el 
nombre del campo encerrado entre corchetes. Además, es posible construir 
búsquedas más complejas usando los operadores `AND' , `OR' y `NOT'. Los campos 
de búsqueda disponibles varian con cada base de datos y pueden obtenerse con el
servicio EInfo. En la tabla \ref{tab:ncbi_nuccore_fields} se muesntran algunos 
de los campos de búsqueda para la base de datos \emph{nuccore}.

Ejemplos:
\begin{itemize}
  \item
  \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="complete+genome"[title]+AND+"Escherichia+coli"[Organism]}{\textbf{esearch.fcgi?db=nuccore\&term="complete+genome"[title]+AND+"Escherichia+coli"[Organi\-sm]}}
  \\
  Recupera los registros que corresponden al microrganismo 
  \textit{Escherichia coli} y que contengan la frase ``complete genome'' en el
  título.
  \item
  \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="complete+genome"[title]+"Escherichia"[Organism]+NOT+"Escherichia+coli"[Organism]}{\textbf{esearch.fcgi?db=nuccore\&term="complete+genome"[title]+"Escherichia"[Organism]+NOT+\-"Escherichia+coli\-"[Organism]}}
  \\
  Recupera los registros de la base de datos \emph{nuccore} que corresponden a
  genomas completas de microrganismos del género \textit{Escherichia}, pero que
  no sean \textit{Escherichia coli}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia"[Organism]+OR+"Bacillus"[Organism]}{\textbf{esearch.fcgi?db=nuccore\&term="Escherichia"[Organism]+OR+"Bacillus"[Organism]}} \\
  Recupera los registros de la base de datos \emph{nuccore} que corresponden a
  los microrganismos del género \textit{Escherichia} o del género 
  \textit{Bacillus}
\end{itemize}

\begin{table}
\small
\begin{center}
\begin{tabular}{llp{9cm}}
Field Name & Nombre completo &                                                                      Descripción \\ \hline
accn &           accession &                                                   Número de acceso de la secuencia \\
auth &              author &                                                          Autores de la publicación \\
 div &            division &                                                       División de la base de datos \\
fkey &         feature key &                                          \emph{Feature} anotado sobre la secuencia \\
gene &           gene name &                                            Nombre del gene asociado a la secuencia \\
 iss &               issue &                                Número de ejemplar (\emph{issue}) de la publicación \\
jour &             journal &                                         Abreviacíón de la nombre de la publicación \\
kywd &             keyword &                                             Palabras clave dadas por el publicante \\
mdat &   modification date &                                                    Fecha de la última modificación \\
orgn &            organism & Nombres científicos y comunes de los organismos, y de los niveles superiores de la clasificación taxonómica \\
pdat &    publication date &                                                      Fecha de publicación original \\
prop &          properties &             Clasificación por calificadores (\emph{qualifiers}) y tipo de molécula \\
slen &     sequence length &                                                           Longitud de la secuencia \\
titl &               title &                                           Contenido del título (\emph{definition}) \\
 uid &                 uid &                                             Número único asignado a cada secuencia \\
\end{tabular}
\end{center}
\normalsize{}
\caption{Campos de búsqueda de la base de datos \emph{nuccore} de NCBI}
\label{tab:ncbi_nuccore_fields}
\end{table}


Los parámetros \emph{retstart} y \emph{retmax} especifican las opciones de 
paginación de los resultados. El primero establece el índice del primer registro
a recuperar y el segundo la cantidad de registros a recuperar. El valor por 
omisión de \emph{retmax} es 20.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia+coli"[Organism]&retstart=0&retmax=100}
  {\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia+coli"[Organism]\&retstart=0\&retmax=100}}} \\
  Recupera los cien primeros registros que corresponden al microrganismo 
  \textit{Escherichia coli}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia+coli"[Organism]&retstart=100&retmax=100}
  {\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia+coli"[Organism]\&retstart=100\&retmax=100}}} \\
  Recupera los registros del 101 al 200, que corresponden al microrganismo 
  \textit{Escherichia coli}.
\end{itemize}

El parámetro \emph{rettype} define que información se va a devolver de la 
búsqueda. Solo acepta dos valores posibles, `uilist' y `count'. Con el primero, 
la opción por omisión, se devuelve una lista con los identificadores de los 
registros. La segunda devuelve el recuento de los registros.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia+coli"[Organism]&rettype=uilist}
  {\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia+coli"[Organism]\&rettype=uilist}}} \\
  Recupera la lista de los identificadores de registros.
  \textit{Escherichia coli}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia+coli"[Organism]&rettype=count}
  {\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia+coli"[Organism]\&rettype=count}}} \\
  Recupera el número de resgistro coincidentes con la búsqueda.
  \textit{Escherichia coli}.
\end{itemize}

El parámetro \emph{retmode} especifíca el formato de respuesta: `xml'
o `json'. 

El parámetro \emph{reldate} permite limitar la búsqueda a los `n' días 
anteriores. Este parámetro requiere el uso del parámetro \emph{datetype}, que 
especifica que tipo de fecha se está buscando (por ejemplo, fecha de publicación o
fecha de última actualización). Los tipos de fechas disponibles es dependiente
de cada base de datos. Se pueden consultar con el sistema EInfo.

Los parámetros \emph{mindata} y \emph{maxdate}, permite la búsqueda de registro
en un rango determinado de fechas. También requiere el uso del parámetro 
\emph{datetype}.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=protein&term=egfr&reldate=60&datetype=pdat&retmax=100}
  {\footnotesize{\texttt{esearch.fcgi?db=protein\&term=egfr\&reldate=60\&datetype=pdat\&retmax=100}}} \\
  Recupera los identificadores de 100 registros de la base de datos \emph{protein}
  que contienen el término `egfr' (de \emph{epidermal growth factor rececetor})
  en alguno de los campos y hayan sido publicadas en los últimos 60 días. 
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=protein&term=egfr&datetype=mdat&mindate=2014&maxdate=2014}
  {\footnotesize{\texttt{esearch.fcgi?db=protein\&term=egfr\&datetype=mdat\&mindate=2014\&maxdate=2014}}} \\
  Recupera los identificadores de todos los registros de la base de datos 
  \emph{protein} que contienen el término `efgr' y cuya última actualización 
  haya sido durante el añoo 2014. 
  \textit{Escherichia coli}.
\end{itemize}

\subsubsection{ESummary}

La URL base es \url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi}.
La función de este servicio es la de proporcionar la información esencial de un
registro a modo de resumen. Esto evita tener que descargar el registro completo.
Usualmente, se lo utiliza como un paso secundario luego de usar el servicio 
ESearch.

Este servicio requiere de los parámetros \emph{db}, para especificar una base de
datos y \emph{id} para indicar de que registros se desea obtener información. Se
pueden especificar hasta 100 registros separando los identificadores con una coma.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=protein&id=894216091}
  {\footnotesize{\texttt{esummary.fcgi?db=protein\&id=894216091}}} \\
  Recupera el resumen del registro con el identificador 894216091 en la base de 
  datos \emph{protein}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=protein&id=894216091,906849281,906849280}
  {\footnotesize{\texttt{esummary.fcgi?db=protein\&id=894216091,906849281,906849280}}} \\
  Recupera el resumen de los registros con los identificadores 894216091, 
  906849281 y 906849280, de la base de datos \emph{protein}.
  \textit{Escherichia coli}.
\end{itemize}

ESummary acepta los parámetros \emph{retstart}, \emph{retmax} y \emph{retmode} 
de la misma forma que ESearch.

\subsubsection{EFetch}
La URL base es \url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi}.
La función de este servicio es la de descargar la información completa de un
registro de una base de datos a partir de su número de identificación. También 
suele usarse, luego de usar el servicio ESearch.

Al igual que ESummary requiere los parámetros \emph{db} y \emph{id} para 
especificar que registros se quiere obtener y de que base de datos.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=protein&id=894216091}
  {\footnotesize{\texttt{efetch.fcgi?db=protein\&id=894216091}}} \\
  Recupera el resumen del registro con el identificador 894216091 en la base de 
  datos \emph{protein}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=protein&id=894216091,906849281,906849280}
  {\footnotesize{\texttt{efetch.fcgi?db=protein\&id=894216091,906849281,906849280}}} \\
  Recupera el resumen de los registros con los identificadores 894216091, 
  906849281 y 906849280, de la base de datos \emph{protein}.
  \textit{Escherichia coli}.
\end{itemize}

Los parámtros \emph{rettype} y \emph{retmode} controlan que tipo de registro 
se quiere descargar y en que formato respectivamente. Los tipos y modos 
disponibles dependen de la base de datos en particular. En la tabla 
\ref{tab:NCBI_rettype_retmode_options} se muestran los tipos y modos 
para algunas de las bases de datos.

Es posible utilizar los parámetros \emph{retstart} y \emph{retmax}, para 
especificar una fracción de los resultados, al igual que en ESearch y ESummary.

El parámetro \emph{strand} permite recuperar, para registros que corresponden a
secuencias de molecula de DNA, una cadena específica. Hay dos valores 
permitidos: `1' para la cadena positiva (o sentido) y `2' para la cadena 
negativa (o antisentido). 

Los parámetros \emph{seq\_start} y \emph{seq\_start} define la región de la secuencia
que se desea recuperar. La primer base de la secuencia es la número `1'.

El parámetro \emph{complexity} permite recuperar los registros con diferentes
grados de complejidad. Los valores permitidos son números del `0' al `4', que
corresponden de mayor complejidad de los datos (`0') a menor complejidad (`4').
Esta opción no está disponible para todas las bases de datos.

\begin{table}[b!]
\begin{center}
\begin{tabular}{lll}
Tipo de registro                              & rettype       & retmode        \\ \arrayrulecolor{black}\hline
\multicolumn{3}{c}{All Databases}                                              \\
Document summary                              & docsum        & xml, default   \\
List of UIDs in XML                           & uilist        & xml            \\
List of UIDs in plain text                    & uilist        & text           \\ \arrayrulecolor[rgb]{.8,.8,.8}\hline
\multicolumn{3}{c}{Base de datos \emph{gene}}                                  \\
% text ASN.1                                    & null          & asn.1, default \\
XML                                           & null          &xml             \\
Gene table                                    & gene\_table   &text            \\ \hline
% \multicolumn{3}{c}{Base de datos \emph{mesh}}                                  \\
% Full record                                   & full, default & text, default  \\ \hline
\multicolumn{3}{c}{Bases de datos \emph{nuccore, nucest, nucgss, protein y popset}}   \\
% ASN.1 texto                                   & null          & text, default  \\
% ASN.1 binario                                 & null          & asn.1          \\
Full record in XML                            & native        & xml            \\
% Accession number(s)                           & acc           & text           \\
FASTA                                         & fasta         & text           \\
TinySeq XML                                   & fasta         & xml            \\ \hline
% SeqID string                                  & seqid         & text           \\ \hline
\multicolumn{3}{c}{Opciones adicionales para \emph{nuccore, nucest, nucgss y popset}} \\
GenBank flat file                             & gb            & text           \\
GBSeq XML                                     & gb            & xml            \\ \hline
% INSDSeq XML                                   & gbc           & xml            \\ \hline
\multicolumn{3}{c}{Opciones adicionales para \emph{nuccore y protein}}         \\
Feature table                                 & ft            & text           \\ \hline
\multicolumn{3}{c}{Opciones adicionales para \emph{nuccore}}                   \\
GenBank flat file with full sequence (contigs)& gbwithparts   & text           \\
CDS nucleotide FASTA                          & fasta\_cds\_na  & text         \\
CDS protein FASTA                             & fasta\_cds\_aa  & text         \\ \hline
\multicolumn{3}{c}{Opciones adicionales para \emph{protein}}                   \\
GenPept flat file                             & gp            & text           \\
GBSeq XML                                     & gp            & xml            \\ \hline
% INSDSeq XML                                   & gpc           & xml            \\
% Identical Protein XML                         & ipg           & xml            \\ \hline
\multicolumn{3}{c}{Base de datos \emph{pubmed}}                                \\
% text ASN.1                                    & null          & asn.1, default \\
XML                                           & null          & xml            \\
% MEDLINE                                       & medline       & text           \\
% PMID list                                     & uilist        & text           \\
Abstract                                      & abstract      & text           \\
\end{tabular}
\end{center}
\caption{Opciones para los parámetros \emph{rettype} y \emph{retmode} para el
servicio EFetch en NCBI. La lista que se muestra corresponde a un subconjunto
seleccionado de las bases de datos disponibles. Para obtener la referencia
completa se puede visitar \url{http://www.ncbi.nlm.nih.gov/books/NBK25499/table/chapter4.T._valid_values_of__retmode_and/?report=objectonly}}
\label{tab:NCBI_rettype_retmode_options}
\end{table}

\newpage
\subsection{European Nucleotide Archive - ENA}
La base de datos ENA ofrece varios servicios para la búsqueda y descarga de 
registros programaticamente usando una interface REST. Además da acceso FTP para
descargar sus datos.

De todos los servicios que ofrece, se discutirán el servicio de recuperación de
datos, el de búsqueda por texto y el acceso por FTP.

\subsubsection{Recuperación de datos - \textit{Data retrieval}}
La URL base de este servicio es '\url{http://www.ebi.ac.uk/ena/data/view/}'.
El uso más sencillo es la búsqueda por el código de identificación del
registro que se quiere recuperar. Por ejemplo, la búsqueda
'\url{http://www.ebi.ac.uk/ena/data/view/KP718916}, recupera el registrodatos
`KP718916'. Es posible, la búsqueda por rango separando dos códigos de
identificación con el símbolo `-'.

Otra opción, es la búsqueda por nombre taxonómico. Este tipo de búsqueda acepta
nombres comunes, nombres científicos y números de identificación de taxa.
En este tipo de búsqueda la URL base es
'\url{http://www.ebi.ac.uk/ena/data/view/Taxon:}' Por ejemplo, la búsquedas que
se muestra debajo recuperan los registros asociados a una especie de laucha.
\begin{itemize}
  \item \url{http://www.ebi.ac.uk/ena/data/view/Taxon:calomys laucha}
  \item \url{http://www.ebi.ac.uk/ena/data/view/Taxon:small vesper mouse}
  \item \url{http://www.ebi.ac.uk/ena/data/view/Taxon:56211}
\end{itemize}

Además, es posible obtener información acerca de proyectos de secuenciación.
Para ello, se necesita el número de identificación del proyecto (project\_id) o
el código de acceso del estudio (study\_accession). La URL para estas búsquedas
se muestran debajo.
\begin{itemize}
  \item http://www.ebi.ac.uk/ena/data/view/study\_accession
  \item Ejemplo: \url{http://www.ebi.ac.uk/ena/data/view/PRJDB1793}
  \item http://www.ebi.ac.uk/ena/data/view/Project:project\_id
  \item Ejemplo: \url{http://www.ebi.ac.uk/ena/data/view/Project:254551}
\end{itemize}

El formato de descarga de los datos es por omisión HTML, sin embargo, esta no 
es la mejor opción si se desea hacer consulta programáticas. ENA ofrece otros
formatos para descargar los datos. Para ello, se utiliza la opción 
\emph{display} en el URL de búsqueda. En la tabla \ref{tab:ena_fmt} se muestran
los formatos aceptados.

\begin{table}[!h]
\begin{center}
\small{}
\begin{tabular}{lp{5cm}p{7cm}}
Opción & Descripción & Ejemplo \\ \hline
html   & Valor por omisión. Muestra los resultados en formato html. Disponible
para todos los tipos de datos &
\url{http://www.ebi.ac.uk/ena/data/view/KP718916&display=html} \\
xml    & Muestra los resultados en formato Xml. Disponible para todos los tipos
de datos & \url{http://www.ebi.ac.uk/ena/data/view/KP718916&display=xml} \\
text   & Muestra los datos en formato de texto plano. Disponible solo para
secuencias con anotación y ensambladas &
\url{http://www.ebi.ac.uk/ena/data/view/KP718916&display=text} \\
fasta  & Muestra los datos en formato fasta. Disponible solo para
secuencias con anotación, ensambladas y \textit{trace} & 
\url{http://www.ebi.ac.uk/ena/data/view/KP718916&display=fasta} \\ 
fastq  & Muestra los datos en formato fastq. Solo disponible para \textit{trace}
& \url{http://www.ebi.ac.uk/ena/data/view/TI1&display=fastq} \\
\end{tabular}
\normalsize{}
\end{center}
\caption{Formatos disponibles en ENA}
\label{tab:ena_fmt}
\end{table}

Además de poder especificar el formato del contenido, se puede definir si se
desea que la descarga sea un archivo de texto plano o un archivo comprimido.
Para ello, se usa la opción \emph{download}. Los valores permitidos son
\emph{txt} y \emph{gzip}.

Este sistema de descarga limita la cantidad de descargas a 100 000 registros por
consulta. Este límite es para evitar la descarga no intencional de un gran
cantidad de datos. Si, es necesario descargar más registros se utiliza la 
opción \emph{lentgh}, cuyo valor es el nuevo número de límite que se desea. Otra
opción importante es \emph{offset} que establece cual es el primer registro que
se descargará. Esto es útil para hacer descargar fragmentadas.

\subsubsection{Búsqueda por texto}
La búsqueda por texto en ENA usa la URL base \url{http://www.ebi.ac.uk/ena/data/warehouse/search}.
La búsqueda se realiza en particiones de las bases de datos denominadas \emph{domain} 
y \emph{result}. La partición \emph{domain} es de mayor nivel de abstracción y 
divide el contenido según su naturaleza. La partición \emph{result} es un 
refinamiento de \emph{domain} que divide la información con algún criteriodatos
adiocional. Por ejemplo, el \emph{domain} `sequence' agrupa los registros que 
contiene información de secuencias nucleotídicas. Para este \emph{domain} hay
dos \emph{result} disponibles: `sequence\_release'  y `sequence\_update'. El 
primero contiene todas las secuencias de la última versión publicada de la
base de datos y el segundo tiene las secuencias que se agregaron o actualizaron
desde esa última publicación. Este último conjunto suele ser mucho más pequeño.
En la tabla \ref{tab:ena_domains_and_results} se muestran todos los \emph{domain} 
y \emph{result} disponibles. 

\begin{table}
\begin{center}
\begin{tabular}{llp{7cm}}
       Domain &             Result &                                                Descripción \\ \hline
     assembly &           assembly &                                        Genomas ensamblados \\
     sequence &  sequence\_release &                        Secuencias de nucleótidos (release) \\
     sequence &   sequence\_update &                         Secuencias de nucleótidos (Update) \\
       coding &    coding\_release &                          Secuencias codificantes (Release) \\
       coding &     coding\_update &                           Secuencias codificantes (Update) \\
    noncoding & noncoding\_release &                       Secuencias no codificantes (Release) \\
    noncoding &  noncoding\_update &                        Secuencias no codificantes (Update) \\
         read &   read\_experiment &                  Lecturas crudas agrupadas por experimento \\
         read &          read\_run &                                            Lecturas crudas \\
         read &        read\_study &            Lecturas crudas agrupadas agrupadas por estudio \\
     analysis &           analysis & Análisis de secuencias de nucleótidos a partir de lecturas \\
     analysis &    analysis\_study & Análisis de secuencias de nucleótidos a partir de lecturas, agrupados por estudio \\
        trace &        read\_trace &                                        Trazas de capilares \\
        study &              study &                                                   Estudios \\
        taxon &              taxon &                                   Clasificación taxonómica \\
       sample &             sample &                                                   Muestras \\
environmental &      environmental &                                       Muestras ambientales \\
\end{tabular}
\end{center}
\caption{Particiones \emph{domain} y \emph{result} disponibles en ENA.}
\label{tab:ena_domains_and_results}
\end{table}

Las búsqueda programáticas por texto, además del parámetro URL \emph{query},
requieren de los parámetros \emph{domain} y \emph{result}. El contenido del 
parámetro \emph{query} no es libre, es decir no es posible hacer una búsqueda 
arbitraria de texto. El contenido del parámetro se construye por opciones de 
filtrado unidos por operadores lógicos (\emph{AND}, \emph{OR}, \emph{NOT})). 
Si se tienen varias opciones de filtrado, se pueden agrupar entre paréntesis.

Las opciones de filtrado se aplican a los distintos campos que posee cada 
registro. Los campos disponibles varian en cada \emph{domain} y \emph{result}.
También, cada campo de búsqueda tienen valores de un tipo particular: \emph{booleano},
\emph{Vocabulario restringido}, \emph{fecha}, \emph{númerico}, \emph{textual},
\emph{geo-espacial} y \emph{taxonómico}. En la tabla \ref{tab:ena_search_fields}
se muestran algunos de los campos de búsqueda más comunes para el \emph{domain=sequence}
y \emph{result=sequence\_release}. Estos campos se comparan con operadores de 
igualdad (`='), diferencia (`!='), mayor y menor (`>', `>=', `<=' y `<'), excepto
los campos de ubicación geográfica y taxonomía. La búsqueda por estos campos
requiere el uso de funciones particulares. En la tabla \ref{tab:ena_search_loc_and_taxon}
se muestran algunas funciones que provee ENA para este tipo de búsqueda.

\begin{table}[h!]
\begin{center}
\small
\begin{tabular}{lp{5cm}p{4cm}l}
Función   & Descripción & Parámetros & Ejemplo \\ \hline
geo\_box1 & La ubicación se encuentra dentro de un cuadrado definido por la 
            esquina superior derecha y la esquina inferior izquierda                              
          & latitud suroeste, longitud suroeste, latitud noreste y longitud 
            noreste
          & geo\_box1(-20,10,20,50)\\
geo\_circ & La unicación se encuentra dentro de un circulo definido por el 
            centro y el radio 
          & Latitud, longitud y radio (km) 
          & geo\_circ(44,00,00) \\
tax\_eq    & Registros que coinciden con un identificador de taxonomía del NCBI 
          & Identificador de taxonomía de NCBI(numérico) 
          & tax\_eq(9606) \\
tax\_tree  & Registros que coinciden con un identificador de taxonomía del NCBI y
            todos sus descendientes. 
          & Identificador de taxonomía de NCBI(numérico) datos
          & tax\_tree(2759) \\
\end{tabular}
\normalsize{}
\end{center}
\caption{Funciones para la búsqueda por geolocalización y por taxonomía}
\label{tab:ena_search_loc_and_taxon}
\end{table}

\begin{table}[h!]
\begin{center}
\small{}
\begin{tabular}{lp{3cm}p{7cm}}
            accession &                   Texto &                                         Número de acceso \\ \hline
          base\_count &                  Número &                                Longitud de la secuencias \\
           cell\_line &                   Texto &              línea celular de donde se obtuvo la muestra \\
              country &                   Texto &        Ubicación de la muestra: País, región y localidad \\
          description &                   Texto &                        Breve descripción de la secuencia \\
environmental\_sample &                Booleano &  Especifíca si el material pertenece a muestra ambiental \\
             keywords &                   Texto &                  Palabras clave asociadas a la secuencia \\
        last\_updated &                   Fecha &                         Fecha de la última actualización \\
%             location &      Latitud y longitud &  Ubicación geográfica de punto aislamiento de la muestra \\
            mol\_type & Vocabulario restringido &           Tipo molecular de la molécula \textit{in vivo} \\
\end{tabular}
\normalsize{}
\end{center}
\caption{Lista de algunos de los campos de búsqueda ofrecidos por ENA.}
\label{tab:ena_search_fields}
\end{table}

La búsqueda por texto ofrece las mismas opciones para manipular el formato de 
los datos a recibir que la búsqueda por identificador que se discutió en la 
primer sección. Se usan los parámetros \emph{display}, \emph{download}, \emph{length}
y \emph{offset} ya vistos (ver la tabla \ref{tab:ena_fmt}). Este tipo de búsqueda
ofrece una opción más para el parámetro \emph{display}, el valor `report'. Esta 
opción permite descargar algunos campos de los registros y no el registro completo.
Es útil para tener en un resumen de los registros que se desea descargar. Cuandodatos
se usa esta opción se requiere el uso del parámetro \emph{fields} para indicar 
los campos que se desea obtener. Debajo se muestran 
algunos de los campo más usuales para el \emph{domain} `sequence' y \emph{result}
`sequence\_release'.

\begin{multicols}{3}
\begin{itemize}
  \item accession
  \item base\_count
  \item cell\_line
  \item description
  \item environmental\_sample
  \item host 
  \item keywords 
  \item last\_updated 
  \item location 
  \item mol\_type 
  \item tax\_division
  \item tax\_id 
  \item scientific\_name
\end{itemize}
\end{multicols}

La referencia completa de los campos de búsqueda y los campos disponibles para 
los reportes se puede consultar en \url{http://www.ebi.ac.uk/ena/data/warehouse/usage}.

\subsubsection{Formato del registro}
\scriptsize{}
\begin{verbatim}
ID   AJ131281; SV 1; linear; genomic RNA; STD; VRL; 348 BP.
XX
AC   AJ131281;
XX
DT   03-DEC-1998 (Rel. 57, Created)
DT   10-DEC-1999 (Rel. 62, Last updated, Version 2)
XX
DE   Lymphocytic choriomeningitis virus z gene, partial, strain MX
XX
KW   RING finger protein; z gene.
XX
OS   Lymphocytic choriomeningitis mammarenavirus
OC   Viruses; ssRNA viruses; ssRNA negative-strand viruses; Arenaviridae;
OC   Mammarenavirus.
XX
RN   [1]
RP   1-348
RA   Pastorek J.;
RT   ;
RL   Submitted (02-DEC-1998) to the INSDC.
RL   Pastorek J., Molecular Biology, Institute of Virology, Slovak Academy of
RL   Sciences, Dubravska cesta 9, 842 46, SLOVAK REPUBLIC.
...
XX
DR   MD5; 520554560ea4a63dc1fe3f175b37a319.
XX
FH   Key             Location/Qualifiers
FH
FT   source          1..348
FT                   /organism="Lymphocytic choriomeningitis mammarenavirus"
FT                   /lab_host="HeLa cells"
FT                   /strain="MX"
FT                   /mol_type="genomic RNA"
FT                   /db_xref="taxon:11623"
FT   CDS             <70..343
FT                   /codon_start=2
FT                   /gene="z"
FT                   /product="ring finger protein"
...
FT                   /experiment="experimental evidence, no additional details
FT                   recorded"
FT                   /protein_id="CAA10342.1"
FT                   /translation="MGQGKSKEKKDTNTGDRAEILPDTTYLGPLNCKSCWQKFDSLVRC
FT                   HDHYLCRHCLNLLLSVSDRCPLCKCPLPTKLKISTAPSPPPPYEE"
FT   mat_peptide     <70..338
FT                   /gene="z"
FT                   /product="ring finger protein"
XX
SQ   Sequence 348 BP; 95 A; 100 C; 77 G; 76 T; 0 other;
     cgtttagttg cgctgtttgg ttgaacagcc ttttcctgtg agagtacaga gacaaaccta        60
...
     gatatcaaca gccccaagcc caccacctcc ctacgaagag taacaccg                    348
//
\end{verbatim}
\normalsize{}
\newpage
\subsection{DNA Data Bank of Japan - DDBJ}
La base de datos DDBJ ofrece, además de la interfaz web, el acceso por FTP y
una API web llamada WABI (Web API for Biology). Estos dos son los recursos que
permiten el acceso programático a esta base de datos.

\subsubsection{Formato del registro}
\scriptsize{}
\begin{verbatim} 
LOCUS       AJ131281                 348 bp    RNA     linear   VRL 10-DEC-1999
DEFINITION  Lymphocytic choriomeningitis virus z gene, partial, strain MX.
ACCESSION   AJ131281
VERSION     AJ131281.1  GI:3970751
KEYWORDS    RING finger protein; z gene.
SOURCE      Lymphocytic choriomeningitis mammarenavirus (LCMV)
  ORGANISM  Lymphocytic choriomeningitis mammarenavirus
            Viruses; ssRNA viruses; ssRNA negative-strand viruses;
            Arenaviridae; Mammarenavirus.
REFERENCE   1
  AUTHORS   Gibadulinova,A., Zelnik,V., Reiserova,L., Zavodska,E.,
            Zatovicova,M., Ciampor,F., Pastorekova,S. and Pastorek,J.
  TITLE     Sequence and characterisation of the Z gene encoding ring finger
            protein of the lymphocytic choriomeningitis virus MX strain
  JOURNAL   Acta Virol. 42 (6), 369-374 (1998)
   PUBMED   10358742datos
REFERENCE   2  (bases 1 to 348)
  AUTHORS   Pastorek,J.
  TITLE     Direct Submission
  JOURNAL   Submitted (02-DEC-1998) Pastorek J., Molecular Biology, Institute
            of Virology, Slovak Academy of Sciences, Dubravska cesta 9, 842 46,
            SLOVAK REPUBLIC
FEATURES             Location/Qualifiers
     source          1..348
                     /organism="Lymphocytic choriomeningitis mammarenavirus"
                     /mol_type="genomic RNA"
                     /strain="MX"
                     /db_xref="taxon:11623"
                     /lab_host="HeLa cells"
     gene            <70..343
                     /gene="z"
     CDS             <70..343
                     /gene="z"
                     /experiment="experimental evidence, no additional details
                     recorded"
                     /codon_start=2
                     /product="ring finger protein"
                     /protein_id="CAA10342.1"
                     /db_xref="GI:3970752"
                     /translation="MGQGKSKEKKDTNTGDRAEILPDTTYLGPLNCKSCWQKFDSLVRdatos
                     CHDHYLCRHCLNLLLSVSDRCPLCKCPLPTKLKISTAPSPPPPYEE"
     mat_peptide     <70..338
                     /gene="z"
                     /product="ring finger protein"
ORIGIN      
        1 cgtttagttg cgctgtttgg ttgaacagcc ttttcctgtg agagtacaga gacaaaccta
 ...
      301 gatatcaaca gccccaagcc caccacctcc ctacgaagag taacaccg
//
\end{verbatim}
\normalsize{}
\subsubsection{Acceso FTP}
DDBJ permite descargas varias bases de datos. Nos enfocaremos en \emph{DDBJ}
(nucleotidos), \emph{DAD} (aminoácidos) y \emph{wgs} (secuenciación de genomas
completos). 
La URL base para ellas son:
\begin{description}
  \item[ddbj] \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/ddbj}
  \item[ddbj - release notes]
  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/release_note_archive/ddbj}
  \item[dad]  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dad}
  \item[dad - release notes] 
  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/release_note_archive/dad}
  \item[wgs]  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/wgs}
  \item[wgs - Lista de organismos]
  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/wgs/WGS_ORGANISM_LIST.txt}
\end{description}

La información en las bases de datos \emph{ddbj} y \emph{dad} está organizada
en diferentes categorías, según el origen de las secuencias. Los archivos de 
datos que pueden ser descargados se corresponden con estas categorías y siguen
una nomenclatura racional. En la tabla \ref{ddbj_ftp_categories} se detallan las
categorías. El nombre de cada archivo está formado por un prefijo que 
corresponde con alguna de las categorías, después un número de orden creciente y
finalmente la extensión. El formato de los archivos es texto plano, comprimido.
Para las bases de datos \emph{ddbj} y \emph{dad}, posible descargar archivos en 
formato \texttt{fasta} y \texttt{XML}. Estos se encuentran en las
subcarpetas \texttt{fasta/} y \texttt{xml/insdxml/v1.4} respectivamente.

\begin{table}[h!tp]
\begin{center}
\begin{tabular}{llp{11cm}}
Categoría  & Prefijo & Descripción \\ \hline
HUM        & ddbjhum & Humano \\
PRI        & ddbjpri & Primates (no humano) \\
ROD        & ddbjrod & Roedores \\
MAM        & ddbjmam & Mamiferos (no primates, ni roedores) \\
VRT        & ddbjvrt & Vertebrados (no mamíferos) \\datos
INV        & ddbjinv & Invertebrados \\
PLN        & ddbjpln & Plantas, hongos, plastidos y otros eukariotas \\
BCT        & ddbjbct & Bacterias y archaeas \\datos
VRL        & ddbjvrl & Viruses \\
PHG        & ddbjphg & Bacteriofagos \\
ENV        & ddbjenv & Secuencias de muestras ambientales \\
SYN        & ddbjsyn & Secuencias de cosntrucciones sintéticas \\
EST        & ddbjest & \textit{Expressed sequence tags}. Secuencias cortas
                       de cDNA \\
GSS        & ddbjgss & \textit{Genome survey sequences}. Secuencias
                       genómicas cortas \\
TSA        & ddbjtsa & Ensamblados de transcriptómica (\textit{Transcriptome
                       shhotgun assemblies}) \\
HTC        & ddbjhtc & Secuencias de cDNA por métodos de alto rendimiento
                       (\emph{high throughput} .
                       Esta categoría incluye secuencias de cDNA no terminadas.
                       Cuando la secuenciación se completa se mueve a la 
                       categoría taxonómica que le corresponde \\
HTG        & ddbjhtg & Secuencias genómicas por métodos de alto rendimiento
                       (\emph{high throughput}) \\
STS        & ddbjsts & \emph{Sequence tagged sites} \\
PAT        & ddbjpat & Secuencias relacionadas con aplicaciones patentadas \\
UNA        & ddbjuna & Secuencias no anotadas. \\
CON        & ddbjcon & Rearmados en proyectos de secuenciación (Contigs) \\
\end{tabular}
\end{center}
\caption{Categorías de las bases de datos de DDBJ}
\label{ddbj_ftp_categories}
\end{table}


\subsubsection{Acceso por Web API}
DDBJ ofrece API para tres servicios diferentes. El servicio WABI BLAST, que 
permite la búsqueda usando Blast. El servicio 'getentry WebAPI' que permite la
recuperar registros de la base de dato por número de acceso y el servicio ARSA 
WebAPI, que permite la búsqueda de registros por su contenido textual (no de 
secuencia. Los tres servicios usan una arquitectura REST 
(\textit{Representational state transfer}) sobre http para las consultas. 



\subsubsection{Getentry WebAPI}
El servicio getentry permite recuperar registro de una de las bases de data de 
DDBJ por su número de acceso. Las consultas se pueden hacer mediante el método
HTML GET o usando una URL semántica. En ambos casos, la URL base es la misma:
'\url{http://getentry.ddbj.nig.ac.jp/getentry}'. La síntaxis para especificar 
una consulta usando el método GET es '\url{http://getentry.ddbj.nig.ac.jp/getentry?database=nombre_de_la_base_de_datos&accession_number=número_de_acceso}' \\
por ejemplo, la consulta '\url{http://getentry.ddbj.nig.ac.jp/getentry?database=ddbj&accession_number=KP177965}' \\
recupera el registro con el número de acceso KP177965. 
La síntaxis para hacer una consulta mediante una URL semántica
La misma consulta, usando
una URL semántica es
'\url{http://getentry.ddbj.nig.ac.jp/getentry/nombre_de_la_base_de_datos/número_de_acceso/revision},
donde 'revisión' es opcional. Los registros pueden ser actualizados en el 
tiempo, cada nueva versión de un registro se carateriza por la fecha y hora de
la actualización. Por ejemplo, la
'\url{http://getentry.ddbj.nig.ac.jp/getentry/ddbj/AY646354/2010-02-26+14:07:01}'
\\ recupera la revisión 2010-02-26 14:07:01 del registro. Para saber que 
revisiones están disponibles para un registro particular se puese hacer una
consulta a la '\url{http://getentry.ddbj.nig.ac.jp/gethistory}', con un formato
similar a la de 'getentry'.

Los parámetros disponibles para las consultas son el \emph{número de acceso},
\emph{base de datos}, \emph{revisión}, \emph{formato}, \emph{tipo de archivo},
\emph{mostrar eliminados} y \emph{limite}.


Para especificar el número se acceso se utiliza la palabla clave
\emph{accession\_number}. Se puede indicar el número de acceso solo (ej.
AY646354), o el número de versión (AY646354.1). Se puede especificar varios 
número de acceso en un sola consulta, separándolos con una coma. También se 
puede indicar un rango de números de acceso, conectando dos número de accesos
con un símbolo '-'. Este parámetros es el único obligatorio.

Para especificar una base de datos se usa la palabra clave \emph{database}.
Las báses de datos disponibles se muestran en la tabla \ref{tab:getentry_dbs}

\begin{table}
\begin{center}
\begin{tabular}{llp{7cm}}
Tipo    & Base de datos & Descripción\\ \hline
DNA     & na            & Busca en todas las bases de datos dispoibles. Es la
                          opción usada por defecto. \\
        & ddbj          & Base de datos propioa de DDBJ. \\
        & wgs           & Base de datos de proyectos de secuenciación de
                          genomas completos (Whole genome sequences). \\
        & mga           & Secuenciación masiva para anotación genómica (Mass
                          sequence for Genome Annotation. \\ \hline
Protein & aa            & Busca en todas las bases de datos disponibles. \\
        & uniprot       & Base de datos Uniprot.\\
        & dad           & Secuencias de aminoácidos de DDBJ. \\
        & patent\_aa    & Secuencias derivadas de patentes. 

El código de revisión se especifica con la palabra clave \emph{revision} y 
consiste en la fecha y la hora con el formato \ttfamily{yyyy-MM-dd hh:mm:ss} o
\ttfamily{yyyy-MM-dd hh:mm:ss release}.

\end{tabular}
\end{center}
\caption{Bases de datos disponibles en \emph{gententry}}
\label{tab:getentry_dbs}
\end{table}

Para especificar el formato de retorno de los datos se utiliza la palabra clave
\emph{format}. En la tabla \ref{tab:getentry_fmts} se muestran los posibles 
valores que puede tomar.

\begin{table}
\begin{center}
\begin{tabular}{ll}
Formato  & Descripción             \\ \hline
flatfile & Formato de texto plano \\
xml      & Formato INSDSeq-XML     \\
fasta    & Secuencias de DNA o proteína en formato fasta \\
trans    & Secuencia codificante traducida a proteínas (fasta) \\
cds      & Secuencia codificante en nucleótidos (fasta)
\end{tabular}
\end{center}
\caption{Formatos de retorno de \emph{getentry}.}
\label{tab:getentry_fmts}
\end{table}

Para especificar que tipo de archivo en que se quiere recuperar los datos se 
usa la palabra clave \emph{filetype}. Los valores posibles son \emph{html}, 
\emph{text} y \emph{gz} (texto plano comprimido).

Es posible recuperar información de registro viejos y que fueron eliminados de
las versiones más recientes de las bases de datos. Para ello, se debe usar la
palabra clave \emph{show\_suppressed}. Los valores posibles son \emph{true} y 
\emph{false}. El valor por defecto es \emph{false}.

Para limitar la cantidad de resultados que se desea recuperar se utiliza el
parámetros \emph{limit}. Cuyo valor es el número máximo de registro que se 
puede recuperar. El valor por defecto es 10. Si se especifica 0, se repueran
todos los registros disponibles.


\subsubsection{ARSA WebAPI.} Está diseñada para ser usada con un navegador web. Los
navegadores compatibles son Firefox y Chrome, IE versiones 9 y 10; y Safari
version 5 y posteriores.

Arsa recupera información de las siguientes bases de datos:
\begin{itemize}
  \item DDBJ Release
  \item DDBJ New (daily updates)
  \item Amino Acid Patent Sequence data submitted from JPO
  \item Amino Acid Patent Sequence data submitted from KIPO.
\end{itemize}

La URL base para la búsqueda es '\url{http://ddbj.nig.ac.jp/arsa/search}'. Los 
resultados pueden ser recuperados en idioma inglés o japonés. Para definir el
idioma es necesario agregar a la dirección base el el capo 'lang' con valor 
'en'. De esta forma la URL se convierte en: 
\url{http://ddbj.nig.ac.jp/arsa/search?lang=en}. El formato de respuesta es HTML,
porque está pensado para ser mostrado en un navegador como una página web.
Si se desea, obtener esta información en un formato que pueda ser fácilmente 
manipulado se tienen dos opciones. Ambas implican usar una URL base diferente. 
Una de las opciones es descargar el contenido de todos los registros en formato
plano, para ello, hay que cambiar a la URL '\url{http://ddbj.nig.ac.jp/arsa/downloadAll?lang=en}'.
La otra opción es recuperar los identificadores de cada registro y luego 
descargar cada uno de ellos, invididualmente con el servicio 'getentry', para 
ello, se debe cambiar la URL base a '\url{http://ddbj.nig.ac.jp/arsa/searchAllIds?lang=en}'. 

Hay dos condiciones de búsqueda, la búsqueda rápida (\textit{Quick Search}) y la
búsqueda avanzada (\textit{Advanced Search}). La condición de búsqueda se define
en el campo 'cond', sus posibles valores son: 'quick\_search' y 'advanced\_search'.
Sin embargo, en esta guía se trabajará solamente con la condición de búsqueda 
simple. El campo 'query' define el texto que se desea buscar. Existen varios opciones
para refinar la búsqueda. Los valores que corresponden a valores booleanos
('AND', 'OR', 'NOT') deben ser escritos en mayúsculas. Para separar dos o más
palabras, en lugar de usar un espacio, se debe usar el signo '+'. 

Las opciones de la búsqueda rápida son las siguientes:
\begin{description}
  \item[Coincidencia por conjunción] Búsquedas que contienen todas las palabras clave 
  dadas. Se debe usar el campo 'operator' con el valor 'AND'. Por ejemplo, la
  búsqueda '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=brain+phosphatidylethanolamine&operator=AND}'\\  
  recupera todos los registros que contienen las palabras 'brain' y
  'phosphatidylethanolamine', aunque se encuentren en lugares diferentes en el
  registro. El primer resultado de la búsqueda del ejemplo es un registro que
  contiene la palabra 'brain' en la definición del registro (título principal)
  y la palabra 'phosphatidylethanolamine' en el título de una de las referencias
  bibliográficas que aparecen en ese registro.
  \item[Coincidencia por disyunción] Búsquedas que contienen al menos una de 
  las palabras clave dadas. Se indican en el campo 'operator' y con el valor 
  'OR'. Por ejemplo, la búsqueda '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=tinea+versicolor&operator=OR}'\\
  recupera registros de 'Tinea versicolor', 'Trametes versicolor' y 'Tinea pellionella'.
  \item[Negación] Búsquedas que contienen una o más palabras clave y que carecen
  de otras que son dadas explicitamente. Se indican con la palabra clave 'NOT'
  dentro del campo 'query', la palabra clave que se encuentra  a su derecha es 
  la que debe estar ausente. Por ejemplo, la búsqueda
  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=homo+NOT+sapiens&operator=AND}'\\
  recupera los registros que contiene la palabros 'homo' pero no 'sapiens'.
  \item[Coincidencia parcial] Búsquedas que contienen parte de una palabra. Se
  indica en el campo 'query'. Al final del término buscado se agrega el
  símbolo '*'. Por ejemplo, la búsqueda '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=candid*}'\\
  recupera registros de '\textit{Candida dubliniensis}', '\textit{Candidatus Phytoplasma}',
  'Junin virus strain candid1', entre otros.
  \item[Coincidencia de frases] Búsquedas que contienen varios términos en el orden
  dado. Se indican encerrando entre comillas los términos. Dependiendo de la 
  herramienta que se utilice, puede ser necesario reemplazar
  las comillas por '\%22'. Por ejemplo, la búsqueda 
  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=%22mouse+brain%22&operator=AND
  }'\\
  recupera los registro que contengan la frase 'mouse brain'.
  \item[Búsquedas en campos] Búsquedas que deben coincidir en un campo 
  particular del registro. Se indican nombrando el campo en el que se debe 
  hacer la búsqueda antes de la palabra clave buscada y separados por el 
  símbolo ':' (o su código de escape '\%3A'). Por ejemplo, la búsqueda
  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=df:``homo+sapiens"&operator=AND}' \\
  recupera registros que tienen la frase 'homo sapiens' en su definición (título principal).
  \item[Búsqueda por expresiones regulares] Algúnas búsquedas en campos permiten
  usar expresiones regulares. Deben encerrarse con el símbolo '/' (o '\%2F'). 
  En la tabla \ref{DDBJ_ARSA_regex} se muestran las expresiones regulares 
  permitidas.
  \item[Búsqueda por rango de valores] Algunas búsquedas en campos permiten 
  indicar un rango de valores para la coincidencia. Deben encerrarse entre 
  corchetes. La palabra clave 'TO' debe estar presente entre el valor
  mínimo y el máximo del rango. Se puede usar el símbolo '*' para indicar un 
  valor de inicio o final del rango desconocido. Por ejemplo, la búsqueda 
  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=pa:[GL000000+TO+GL000010]&operator=AND}' \\
  recupera los registros existentes cuyo número de acceso primario sea 
  'GL000001', 'GL000002',  \ldots y 'GL000010'. Otro ejemplo,  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=sl:[0+TO+100]&operator=AND}' \\
  recupera todos los registros cuya longitud de secuencia sea 100 o menos.
\end{description}


\begin{table}
\small{}
\begin{center}
\begin{tabular}{lrp{7cm}}
Nombre del campo        & Abr. & Description  \\ \hline
PrimaryAccessionNumber  & pa   & Primer número de acceso en ACCESSION \\
AccessionNumber         & an   & Números de acceso en ACCESSION \\
Division                & dv   & Division en LOCUS (ej. VRL=virus) \\
SequenceLength          & sl   & Longitud de secuencia en LOCUS \\
MolecularType           & mt   & Tipo de molecula in LOCUS (ej. RNA) \\
MolecularForm           & mf   & Estructura molecular (ej. linear) \\
Date                    & dt   & Última fecha de publicación en LOCUS  \\
Definition              & df   & Texto en DEFINITION \\
Comment                 & cm   & Texto en COMMENT \\
Keyword                 & kw   & Texto en KEYWORDS \\
Organism                & og   & Texto en el organismo de ORGANISM \\
Lineage                 & ln   & Texto en el linaje de ORGANISM \\
ReferenceAuthor         & ra   & Texto en AUTHORS de REFERENCE \\
ReferenceTitle          & rt   & Texto en TITLE de REFERENCE \\
ReferenceJournal        & rj   & Texto en JOURNAL de REFERENCE \\
ReferencePubmedID       & rp   & Texto en PUBMED de REFERENCE \\
Feature                 & fe   & Texto en FEATURES \\
\end{tabular}
\end{center}
\normalsize{}
\caption{Campos de búsqueda disponibles en DDBJ}
\label{tab:DDBJ_fields}
\end{table}

\begin{table}
\begin{center}
\small
\begin{tabular}{p{4cm}lp{8cm}}
Significado                             & Simbolo   & Ejemplo \\ \hline
Cualquier caracter individual           & .         & /ho.o/ coincide con 'homo' y con 'Rhodococcus'. \\
Cualquier caracter cero o más veces     & *         & /XX1*/ coincide con 'XX', 'XX1', 'XX11', etc \\
Cualquier caracter cero o una vez       & ?         & /XY?123/ coincide con 'XY123' and 'X123' \\
Cualquier caracter una o más veces      & +         & /XY1*/ coincide con 'XY1', 'XY11',etc, pero no con 'XY' \\
Cualquier caracter en un grupo          & [abc]     & /ho[dm]o/ coincide con 'homo' y con 'Rhodococcus', pero no con 'Achoropsyche' \\
Cualquier caracter excepto algunos      & [\^{}abc] & /ho[\^{}d]o/ coincide con 'homo'y con 'Achoropsyche', pero no con 'Rhodococcus' \\
Cualquier caracter en un rango          & [a-z0-9]  & /XY[1-9]00/ coincide con 'XY100', 'XY200', etc, 'XYA00', 'XYB00', etc \\
Cualquier caracter exactamente n vences & \{n\}     & /XY1{2}/ coincide con 'XY11' pero no con 'XY0' o 'XY000' \\
Cualquier caracter n o más veces        & \{n,\}    & /XY1{2,}/ coincide con 'XY11' y 'XY111', pero no con 'XY1' \\
Cualquier caracter n hasta m veces      & \{n,m\}   & /XY1{2,3}/ coincide con 'XY11' y con 'XY111', pero no con 'XY1' o 'XY1111' \\
\end{tabular}
\normalsize{}
\end{center}
\caption{tablecaption}
\label{tablelabel}
\end{table}

\subsubsection{WABI BLAST}
DDBJ ofrece una API web, e interface para hacer consultas con Java, perl y Ruby.
Sin embargo, la documentación solo está disponible en japonés, por ello lo 
dejaremos fuera de la discusión. Si se desea ver en detalle la documentación 
disponible, visite la página
'\url{http://www.ddbj.nig.ac.jp/search/help/wabi/wabi_blast_example-j.html}'.

\newpage
\section{Bases de datos secundarias}

\subsection{Uniprot}
Uniprot es un conjunto de bases de datos que reune información sobre anotación
de proteínas. Toma datos de protéinas de otras bases de datos y luego agrega
y cura la anotación. Uniprot está compuesta de tres bases de datos, \emph{UniParc},
\emph{UniProtKB} y \emph{Uniref}. \emph{UniParc} (\emph{Uniprot archive}) es una
colección extensiva de practicamente todas las secuencias de proteínas disponibles
en las bases de datos públicas, sin importar si están anotadas o no. \emph{UniprotKB}
es una base de datos derivada de \emph{UniParc} que contiene solamente las proteínas
que contienen anotaciones, manuales o generadas automáticamente. Esta subdividida 
en otras dos bases de datos, \emph{Swiss-Prot} y \emph{TrEMBL}. \emph{Swiss-Prot}
contiene las proteínas con anotaciones curadas de forma manual, mientras que 
\emph{TrEMBL} contiene aquellas que fueron anotadas automáticamente. Cuando la  
anotación de un miembros \emph{TrEMBL} se revisa, es pasada a \emph{Swiss-Prot}.
El tamaño de \emph{Swiss-Prot} es cerca del 1\% de \emph{UniprotKB}. Por último,
\emph{UniRef} contiene conjunto de proteínas (\emph{clusters}) con diferente 
grado de identidad. \emph{UniRef} ofrece tres subconjuntos: 
\begin{description}
  \item [UniRef100] Contiene secuencias idénticas de tamaño total o menor.
  \item [UniRef90]  Contiene secuencias con una identidad del 90\% o más y cubriendo 80\% de la longitud de la proteína de mayor tamaño en el conjunto.
  \item [UniRef50]  Contiene secuencias con una identidad del 50\% o más y cubriendo 80\% de la longitud de la proteína de mayor tamaño en el conjunto.
\end{description}  

\emph{Uniprot} ofrece una interface Rest para acceder a sus bases de datos. Con
ella es posible, hacer búsquedas por texto y recuperar registros por código de 
identificación. Además, \emph{Uniprot} ofrece un servicio que permite mapear
identificadores entre las bases de datos propias (por ejemplo, entre 
\emph{UniprotKB} y \emph{UniParc}), y entre bases de datos de propias y 
enternas.

\subsubsection{Búsqueda por identificador}
La URL base para recuperar un registro por identificador es 
\url{http://www.uniprot.org/base_de_datos/codigo.formato}. Cada base de datos
utiliza códigos de identificación de diferente naturaleza. Una misma proteína,
tiene un identificador diferente en \emph{Uniprot} y en \emph{UniParc}. Los
formatos aceptados son `txt', `fasta', `tab', `xml' y `rdf'. El formato `tab' recupera 
una tabla de texto que contiene el código y nombre del registro, el estado de 
revisión, el nombre de los genes y proteínas, el organismo de origen y su 
longitud.

Ejemplos:
\begin{itemize}
  \item \url{http://www.uniprot.org/uniprot/Q16654.fasta}
  \item \url{http://www.uniprot.org/uniprot/Q16654.xml}
  \item \url{http://www.uniprot.org/uniprot/Q16654.tab}
  \item \url{http://www.uniprot.org/uniparc/UPI000000D984.xml}
  \item \url{http://www.uniprot.org/uniref/UniRef50\_Q16654.fasta} \\
  Todos corresponden a la enzima piruvato deshidrogenasa.
\end{itemize} 

De esta forma es posible obtener registros de a uno a la vez. Si se quiere
obtener varios registros en una sola consulta es necesario utilizar otro 
servicio llamado \emph{batch}. La URL base de este servicio es 
\url{http://www.uniprot.org/batch/}. Se requieren de dos parámetros. Uno de 
ellos es \emph{format},
que especifica el formato del registro, los valores aceptados son txt', `fasta' 
y `xml'. El segundo parámetro es \emph{query} que acepta una lista de 
indentificadores cuyos registro se desea obtener. Se pueden obtener registros
de \emph{UniProtKB}, \emph{UniRef} y \emph{UniParc}, sin embargo en la lista de
identificadores que se pasa todos deben corresponder a la misma base de datos.
Este servicio requiere que los datos sean pasados por un pedido tipo POST.
Por ello, no es posible probarlo en el navegador \textit{web}. Para hacer este
tipo de consulta se puede escribir un pequeño programa en \emph{Perl}, 
\emph{Python}, \emph{Ruby}, \emph{Java}, etc o usar el programa \emph{cURL}, u 
otro similar. Aunque este servicio permite descargar muchos registros a la vez, 
si se tiene un gran número de registros, conviene dividir la carga en varias
consultas.
 
Ejemplos para cURL:
\begin{itemize}
  \item \texttt{curl -L -d format=xml -d "query=P13368 Q16654"\ http://www.uniprot.org/batch/ -o out.xml} 
  Permite recuperar los registros P13368 y Q16654, en formato `xml' y los guarda
  en el archivo `out.xml'.
  \item \texttt{curl -L -d format=txt -d "query=P13368 Q16654"\ http://www.uniprot.org/batch/ -o out.txt} 
  Permite recuperar los registros P13368 y Q16654, en formato de texto plano y 
  los guarda en el archivo `out.txt'.
\end{itemize}

\subsubsection{Búsqueda por texto}
La URL base de este servicio es \url{http://www.uniprot.org/uniprot/}. 
Requiere del parámetro \emph{query} que contiene el texto que se quiere buscar.
El contenido de \emph{query} esta formado por varios campos unidos por operadores
booleanos. Sino se especifica ningún campo, la búsqueda se hace sobre todos los 
campos. En la tabla \ref{tab:uniprot_search_fields} se muestran algunos de los
campos de búsqueda más usuales.

\begin{table}
\begin{center}
\footnotesize
\begin{tabular}{lp{7cm}}
Formato & Descripción \\ \hline
html    & Formato HTML para ver en un navegador. \\
tab     & Muestra información parcial del registro en formato de texto tabular. \\
xls     & Muestra el mismo contenido que la opción `tab', pero en formato de tabla de MS-Excel. \\
fasta   & Muestra solo la secuencia de la proteína en formato fasta. \\
gff     & Muestra anotaciones de secuencia. \\
txt     & Muestra el registro completo en formato de texto plano. \\
xml     & Muestra el registro completo en formato XML. \\
rdf     & Muestra el registro completo en formato rdf (\textit{Resource Description Framework}). \\
list    & Muestra una lista de identificadores. \\
rss     & Devuelve un RSS Feed (\textit{Really Simple Syndication}. 
\end{tabular}
\normalsize{}
\end{center}
\caption{Formatos permitidos por \emph{UniProt}}
\label{tab:uniprot_fmt}
\end{table}

\begin{table}
\begin{center}
\footnotesize
\begin{tabular}{llp{7cm}}
Campo      &                                   Ejemplo  & Descripción  \\ \hline                             
 accession &                           accession:P62988 & Registros con número de acceso P62988. \\
    active &                                  active:no & Registros obsoletos. \\
    author &                           author:ashburner & Registros cuyo uno de los co-autores sea Ashburner. \\
  citation & citation:(author:ashburner journal:nature) & Registros cuyo uno de los co-autores sea Ashburner y haya sido publicado en \emph{Nature}. \\
   cluster &                   cluster:UniRef90\_A5YMT3 & Registros que pertenecen a \emph{UniRef90} y cuya secuencia secuencia representativa sea la del registro A5YMT3 de \emph{UniProtKB}. \\
   created &                    created:[20121001 TO *] & Registros creados después del 01/10/2012. \\
  database &                   database:(type:pdb 1aut) & Registros que hagan referencia al registro 1AUT de la base de dato externa PDB \\
    domain &                              domain:3fe-4s & Registros que contengan un dominio 3Fe-4S (formado por trés atomos de hierro y cuatro de azufre). \\
        ec &                                 ec:1.1.1.1 & Registros que pertenezcan a enzima con E.C. \textit{number} 1.1.1.1 (Alcohol deshidrogenasa). \\
    family &                              family:serpin & Registros que pertenezcan a la familia de Serpinas. \\
  fragment &                               fragment:yes & Lists all entries with an incomplete sequence. \\
      gene &                                 gene:erbb1 & Registros de proteínas codificadas por el gen \emph{erbb1}. \\
        go &                            go:cytoskeleton & Registros asociados con el término GO `cytoskeleton' \\
      host &                                 host:mouse & Registros de las proteínas de organismos que infectan a ratones \\
        id &                                  id:P00750 & Registros cuyo número de acceso primario es P00750. \\
interactor &                          interactor:P00520 & Registros de proteínas para las que está descripta una interacción con la proteína del registro P00520. \\
   keyword &                              keyword:toxin & Registros asociados con la palabra clave `toxin' \\
    length &                        length:[100 TO 200] & Registros de proteínas cuyo tamaño está entre 100 y 200 residues. \\
      mass &                         mass:[200000 TO *] & Registros de proteínas cuyo peso molecular es mayor a 200KDa \\
  modified &            modified:[20140701 TO 20150701] & Registros que fueron actualizados entre el 01/07/2014 y el 01/07/2015 \\
      name &                       name:"nucleoprotein" & Resgistros cuyo nombre coincida con `nucleoprotein' \\
 organelle &                    organelle:Mitochondrion & Registros de proteínas codificadas por el cromosoma mitocondrial. \\
  organism &                    organism:"mus musculus" & Registros de todas las proteínas codificadas por \emph{Mus musculus}. \\
  reviewed &                               reviewed:yes & Registros de las proteínas revisadas (\emph{Swiss-Prot}). \\
  taxonomy &                      taxonomy:arenaviridae & Registros de que pertenezcan al taxón \emph{Arenaviridae}. \\
\end{tabular}
\end{center}
\normalsize{}
\caption{Campos de búsqueda por texto más comunes en Uniprot.}
\label{tab:uniprot_search_fields}
\end{table}

El parámetro \emph{format} permite especificar el formato que se desea para el
registro. En la tabla \ref{tab:uniprot_fmt} se muestran los formatos permitidos.
Cuando se usa el parámetro \emph{format} con el valor `tab', se tiene la opción 
de especificar que datos se quieren obtener en la tabla. Para ello, se debe usar
el parámatro \emph{columns} e indicar en su valor las columnas de datos. Para
especificar más de un valor, solamente hay que separarlos con una coma. En la
tabla \ref{tab:uniprot_column_values} se muestran algunos valores posibles.
Para obtener una referencia completa, visitar la URL 
\url{http://www.uniprot.org/help/uniprotkb_column_names}.

El parámetro \emph{include} permite incluir información adicional para algunos
formatos en particular. Cuando el formato es `fasta', se incluyen secuencias de
las isoformas de la proteína. Cuando el formato es `rfd' se incluyen descripciones
de los datos referenciados. Para los demás formatos no tiene efecto.

Los parámetros \emph{limit} y \emph{offset} permiten especificar el tamaño 
máximo de registros a recuperar y el índice en el cual se comienza. Por omisión,
el valor de \emph{limit} no está definido, por lo que se descargan todos los 
registros.

Los parámetros \emph{sort} y \emph{desc} permiten modificar el orden en que se
obtienen los resultados. El parámetro \emph{sort} permite especificar el campo
del registro se utiliza como criterio para asignar el orden. El parámetros
\emph{desc} permite establecer si el orden es ascendente (\emph{desc=no}) o 
descendente (\emph{desc=yes}). Por omisición el orden es descendente.
 
\begin{table}
\begin{tabular}{ll}
Campo         & Descripción \\ \hline
           id & Código de identificación. \\
   entry name & Nombre del registro. \\
     comments & Comentarios agregados por el autor al registro. \\
           ec & Número E.C. (Enzyme Catalog). \\
    existence & Evidencia de la existencia de la proteína. \\
     families & Familias a la que pertenece la proteína \\
     features & Tabla de anotaciones. \\
        genes & Genes relacionados con la proteína. \\
           go & Término de Gene-Ontology relacionados con la proteína. \\
     keywords & Palabras clave dadas por el autor.\\
last-modified & Fecha de la última modificación. \\
       length & Longitud de la secuencia de la proteína. \\
     organism & Nombre del organismo de origen. \\
  organism-id & Número de identificación taxonómica. \\
     reviewed & Indica si la proteína fue revisada (Pertenece a Swiss-Prot) \\
     sequence & Secuencia de aminoácidos de la proteína \\
           3d & Muestra que resultados de estructura tridimensional existen para la proteína \\
\end{tabular}
\caption{Lista de algunos campos que se pueden recuperar en el formato de texto 
tabular en \emph{UniProt}.}
\label{tab:uniprot_column_values}
\end{table}

\subsubsection{Mapeo de identificadores}
\emph{Uniprot} ofrece un servicio que permite mapear idenficador entre bases de
datos internas y externas. La URL base es 
\emph{http://www.uniprot.org/help/mapping/}. Para usar este sercicio es
necesario espeficicar cuatro parámetros: \emph{from}, \emph{to}, \emph{format} y
\emph{query}. Los parámetros \emph{from} y \emph{to} permiten especificar las 
bases de datos de origen y de destino. Para ello, cada base de datos tiene un 
código de identificación. En la tabla \ref{tab:unitprot_mapping_dbs_id} se muestran
algunos de ellos. Para obtener una lista completa visitar la URL 
\url{http://www.uniprot.org/help/programmatic_access#id_mapping_examples}. 

El parámetro \emph{format} permite especificar el formato de los resultados. 
El único valor aceptado es `tab', que muestra una tabla de texto de dos columnas,
en la primera de ellas se encuentra el identificador de origen y en la segunda 
el identificador de la base de datos de destino. Es posible que a un mismo 
identificador en una base de datos le correspondan varios en otra base de datos.

El parámetro \emph{query} permite indicar el identificador de la base de datos 
de origen que se quiere mapear. Es posible especificar varios, separándolos con
un espacio en blanco.

Ejemplos:
\begin{itemize}
  \item \texttt{curl -L -d from=ACC -d to=ID -d format=tab -d "query=Q6IUF8 Q6IUF7 Q6IUF9 P26578"\ http://www.uniprot.org/mapping/} \\
  Recupera el código de identificación de \emph{UniProt} a partir de su número 
  acceso.
  \item \texttt{curl -L -d from=ACC -d to=P\_GI -d format=tab -d "query=Q6IUF8 Q6IUF7 Q6IUF9 \\
  P26578"\ http://www.uniprot.org/mapping/} \\ 
  Recupera el código GI de las bases de datos de \emph{NCBI} a partir de su número 
  acceso.
  \item \texttt{curl -L -d from=ID -d to=PDB\_ID -d format=tab -d "query=THIO\_ECOLI"\ http://www.\ uniprot.org/mapping/} \\
  Recupera el código de los registros de la bases de datos PDB asociados a la 
  proteína tiorredoxina de \emph{Escherichia coli}.
\end{itemize} 

\begin{table}
\begin{center}
\begin{tabular}{ll}
Base de datos         & Identificador  \\ \hline
\multicolumn{2}{c}{Bases de datos de \emph{Uniprot}} \\
      UniProtKB AC/ID &         ACC+ID \\ \arrayrulecolor[rgb]{.8,.8,.8}\hline
         UniProtKB AC &            ACC \\
         UniProtKB ID &             ID \\
              UniParc &          UPARC \\
             UniRef50 &           NF50 \\
             UniRef90 &           NF90 \\
            UniRef100 &          NF100 \\
            Gene name &       GENENAME \\
\multicolumn{2}{c}{Otras bases de datos} \\ \hline
    EMBL/GenBank/DDBJ &       EMBL\_ID \\
EMBL/GenBank/DDBJ CDS &           EMBL \\
            GI number &          P\_GI \\
       RefSeq Protein &  P\_REFSEQ\_AC \\
    RefSeq Nucleotide & REFSEQ\_NT\_ID \\
\multicolumn{2}{c}{Bases de datos de estructuras 3D} \\ \hline
                  PDB &         PDB\_ID \\
\end{tabular}
\end{center}
\caption{Identificadores de las bases de datos para el servicio de mapeo de bases de datos de \emph{UniProt}}
\label{tab:unitprot_mapping_dbs_id}
\end{table}

\newpage
\section{Ejercitación}
\subsection*{Ejercicio 1}
Utilice el servicio EInfo de Entrez para construir una tabla que contenga 
el nombre de la base de datos, la descripción, el número de registros, y la
fecha de la última modificación para todas las bases de datos disponibles.

\subsection*{Ejercicio 2}
Obtenga de la base de datos `nuccore' de NCBI el número de registros que 
corresponden con secuencias del virus HIV-1 que fueron publicadas en cada año 
desde 1980 hasta 2015. Haga un gráfico de barras para mostrar estos resultados.
Repita esta operación usando ENA y DDBJ. 

\subsection*{Ejercicio 3}
\begin{itemize}
  \item Buscar información sobre la base de datos MESH (NCBI).
  \item Buscar en esta base de datos el nombre del gen relacionado con la enfermedad Fibrosis Quística (\textit{Cystic fibrosis}). 
  \item Buscar en la base de datos `gene' de NCBI, los registros de este gen en el ser humano (en formato XML).
  \item Recuperar la lista de exones. ¿En qué locus está ubicado el gen?.
  \item Buscar en Swiss-Prot los registros que están asociados a esta proteína. 
  \item Recuperar las secuencias de la proteína.
\end{itemize}

\subsection*{Ejercicio 4}
Recuperar los registros que corresponden a secuencias nucleotídicas de genomas
completos de virus de la familia \textit{Flaviviridae}. 
Generar un histograma de los tamaños de las secuencias.
Obtener de cada registro el código del `TaxID'. 
Buscar en la base de datos `Taxonomy' el nombre científico de cada uno y el 
acrónimo (si corresponde).

\subsection*{Ejercicio 5}
Buscar en la ENA, los registros de secuencias de HIV-1 que fueron obtenidas en 
el hemisferio sur del continente americano en ENA.

\subsection*{Ejercicio 6}
Recuperar todos los registros que corresponden a secuencias de `Amapari virus' en
la base de datos `nuc_core'. Recuperar de ellos los identificadores de las 
publicaciones relacionadas. Obtener de `pubmed' el título del artículo, los
autores y el \textit{abstract}.

\subsection*{Ejercicio 7}
\begin{itemize}
  \item Buscar en base de datos `SRA' (\textit{Sequence Read Archive}) de NCBI los 
registros que corresponden a los proyectos de secuenciación de virus de la 
familia \textit{Baculoviridae}.
  \item Recuperar de cada ellos el nómbre del organismo secuenciado y su `TaxId', el 
título del proyecto, el número de bases leidas, la longitud de la secuencia 
obtenida.
  \item generar histogramas de la calidad de la lectura.
  \item determinar el porcentage de bases que no fueron determinadas (son `N' 
  en la secuencia).
\end{itemize}

\subsection*{Ejercicio 8}
Buscar en \emph{UniProtKB} las secuencias de la enzima Hipoxantina-guanina 
fosforribosiltransferasa (\textit{Hypoxanthine-guanine phosphoribosyltransferase}, HGPRT)
de eucariotas. 
\begin{itemize}
  \item Generar un alineamiento.
  \item Distinguir cuales pertenecen a \emph{Swiss-Prot} y cuales a \emph{TrEMBL}.
  \item Mostrar para cada una de ellas que evidencia hay de su existencia. 
  \item Buscar si tienen referencia a la base de datos pFam (\textit{protein families}).
\end{itemize}

\subsection*{Ejercicio 8}
Buscar en \emph{UniProtKB} las secuencias de la enzima Hipoxantina-guanina 
fosforribosiltransferasa (\textit{Hypoxanthine-guanine phosphoribosyltransferase}, HGPRT)
de eucariotas. 
\begin{itemize}
  \item Generar un alineamiento.
  \item Distinguir cuales pertenecen a \emph{Swiss-Prot} y cuales a \emph{TrEMBL}.
  \item Mostrar para cada una de ellas que evidencia hay de su existencia. 
  \item Buscar si tienen referencia a la base de datos pFam (\textit{protein families}).
\end{itemize}

\subsection*{Ejercicio 9}
Buscar en las bases de datos de KEGG (\textit{Kyoto Encyclopedia of Genes and Genomes}), 
las enfermedades relacionadas con la vía metabólica de síntesis de Arginina. 
Buscar para cada una de ellas, la proteína en \emph{Swiss-Prot} que le 
corresponde y el nombre del gen asociado. Buscar los SNP disponibles en la base
de datos `SNP' de NCBI. Recuparar la ubicación (cromosoma y posición de base y 
la secuencia reportada).
\end{document}
