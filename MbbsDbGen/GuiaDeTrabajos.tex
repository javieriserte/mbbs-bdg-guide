\documentclass[a4paper, twoside]{article}%
%Options -- Point size:  10pt (default), 11pt, 12pt
%        -- Paper size:  letterpaper (default), a4paper, a5paper, b5paper
%                        legalpaper, executivepaper
%        -- Orientation  (portrait is the default)
%                        landscape
%        -- Print size:  oneside (default), twoside
%        -- Quality      final(default), draft
%        -- Title page   notitlepage, titlepage(default)
%        -- Columns      onecolumn(default), twocolumn
%        -- Equation numbering (equation numbers on the right is the default)
%                        leqno
%        -- Displayed equations (centered is the default)
%                        fleqn (equations start at the same distance from the right side)
%        -- Open bibliography style (closed is the default)
%                        openbib
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Lista de Paquetes
\usepackage{pifont}             % Maneja Fuentes 
%\usepackage{PTSans}            % Maneja Fuentes Sans Serif
%\usepackage{skak}              % simbolos de ajedrez
\usepackage[T1]{fontenc}        % Texto de alta calidad en pdfs
\usepackage{ae,aecompl}         % Texto de alta calidad en pdfs
\usepackage{pslatex}            % Texto de alta calidad en pdfs
\usepackage{textcomp}           % Cosas de Texto
\usepackage{multicol}           % Para manejar multiples columnas
\usepackage[ansinew]{inputenc}  % Para poner acentos
\usepackage[spanish,es-tabla]{babel}     % Para separar palabras al fin de los
% renglones.
\usepackage{amsmath}            % Para hacer matemática
\usepackage{amsfonts}           % Para hacer matemática
\usepackage{amssymb}            % Para hacer matemática
\usepackage{enumerate}          % Para Manehar Enumeraciones
\usepackage{vwcol}              % para manejar multiples columas
\usepackage{graphicx}           % Para manejar los grÃ¡ficos
\usepackage{fancyhdr}           % Para manejar encabezados y pie de pÃ¡ginas
\usepackage{lastpage}           % Crea una referencia a la Ãºltima pÃ¡gina. Util
                                % para numerar pÃ¡ginas de la forma "pÃ¡gina x de y"
%\usepackage[final]{ps4pdf}     % para incluir archivos eps dentro del documento pdf
\usepackage{array}
\usepackage{soul}
\usepackage{boolexpr}
\usepackage[hyphens]{url}   % Typeset urls
\usepackage[pdfborder={0 0 0 [3 3]}]{hyperref}       % Hipervísnculos en las url
\usepackage{colortbl}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Configuración de página
\textwidth 15cm               
\textheight 25.7cm            
\oddsidemargin 1cm           
\evensidemargin 0cm          
\topmargin -1.5cm             
\headheight 0cm               
\headsep 10pt                 
\marginparwidth 0cm
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% BibliografÃ­a
\bibliographystyle{alpha}      
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Titulo
\newcommand{\s}{\the\textwidth}
\newcommand{\materiaName}{Bases de datos genomicas}
\newcommand{\seminarioName}{Guia de trabajos practicos}
\newcommand{\fecha}{Julio de 2015}
\newcommand{\titulo}{
  \begin{center}
  \vspace*{-22pt}\large\textbf{\materiaName}\\
  \vspace{2pt}\normalsize{\seminarioName}\\
  \vspace{2pt}\small{Maestría en bioinformática y biología de sistemas}\\
  \vspace{-6pt}\rule{\textwidth}{0.4pt}
  \end{center}
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Encabezado y Pie de PÃ¡gina
 \headheight=14pt
 \renewcommand{\headrulewidth}{0.4pt}                                 
 \renewcommand{\footrulewidth}{0.4pt}                                 
 \pagestyle{fancy}                                                   
 \fancyfoot{}
 \lfoot{\footnotesize{Página \thepage\ de \pageref{LastPage}}}        
 \lhead{\footnotesize{\materiaName}}
 \rhead{\footnotesize{\fecha\  - \seminarioName}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fuentes
%\renewcommand{\familydefault}{\sfdefault} % Cambia todas las fuentes a sans 
                                           % Serif
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
                                 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Enumeraciones
\renewcommand{\theenumi}{\alph{enumi}}
\renewcommand{\labelenumi}{\textbf{\theenumi}}
\renewcommand{\theenumii}{\arabic{enumii}}
\renewcommand{\labelenumii}{\theenumii}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Fin del preludio
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}
\titulo
 
\section{Bases de datos primarias de nucleótidos}

\subsection{National Center of Biotechnology Information - NCBI}
El NCBI ofrece un conjunto de herramientos para el acceso programático a sus 
bases de datos que se llama NCBI E-utilities y se basa en una interface REST.
Cada una de ellas, tiene una URL base particular y está destindada a ofrecer
diferentes funciones. Es importante que NCBI, no solo ofrece acceso a base de 
datos de secuencias, sino de otro tipo, como por ejemplo bibliográfico a 
través de \emph{Pubmed}.
 
\subsubsection{EInfo}
La URL base de este servicio es `\url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/einfo.fcgi}'.
Su función es simplemente dar los nombres y estadísticas acerca de las bases de 
datos disponibles. Si se consulta esta base de datos sin ningún parámetro 
devuelve un listado de los nombres de las bases de datos disponibles en el 
sistema. 

El parámetro \emph{db} permite especficar una base de datos particular y obtener
información sobre ella. El formato de respuesta es por omisión XML, pero puede
ser modificado con el parámetro \emph{retmode}. Este parámetro tiene dos valores
posibles, `XML' y `json'. Adicionalmente, se puede usar el parámetro \emph{version}
que solo acepta un valor `2.0', para especificar que los datos se recuperen en
la versión 2.0 Einfo XML. La diferencia entre la versión por omisión y la 2.0 
es el agregado de dos términos, `IsTruncatable' y `IsRangeable', en los 
la descripción de los campos de los registros de la base de datos.

Ejemplo:
\begin{itemize}
  \item \url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/einfo.fcgi?db=protein&version=2.0} \\
  Recupera información sobre la base de datos \emph{protein} en la versión 2.0.
\end{itemize}

\subsubsection{ESearch}
La URL base de este servicio es \url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi}.
Permite la búsqueda por texto en las bases de datos, como resultado devuelve
una lista de número de identificación de cada registro. 

Este servicio requiere que especificar la base de datos en la cual buscar, para 
ello se utiliza el parámetro \emph{db}. 

Además, se requiere del parámetro 
\emph{term} para detallar el texto que se desea buscar. La búsqueda por texto,
recupera registros que coinciden con el texto ingresado en cualquier campo.
Sin embargo, es posible ser más específico, y restringir la búsqueda a un 
campo en particular. Para ello, luego del término de búsqueda se adiciona el 
nombre del campo encerrado entre corchetes. Además, es posible construir 
búsquedas más complejas usando los operadores `AND' , `OR' y `NOT'. Los campos 
de búsqueda disponibles varian con cada base de datos y pueden obtenerse con el
servicio EInfo. En la tabla \ref{tab:ncbi_nuccore_fields} se muesntran algunos 
de los campos de búsqueda para la base de datos \emph{nuccore}.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="complete+genome"[title]+AND+"Escherichia+coli"[Organism]}{\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="complete+genome"[title]+AND+"Escherichia+coli"[Organism]}}} \\
  Recupera los registros que corresponden al microrganismo 
  \textit{Escherichia coli} y que contengan la frase ``complete genome'' en el
  título.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="complete+genome"[title]+"Escherichia"[Organism]+NOT+"Escherichia+coli"[Organism]}{\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="complete+genome"[title]+"Escherichia"[Organism]+NOT+"Escherichia+coli\-"[Organism]}}} \\
  Recupera los registros de la base de datos \emph{nuccore} que corresponden a
  genomas completas de microrganismos del género \textit{Escherichia}, pero que
  no sean \textit{Escherichia coli}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia"[Organism]+OR+"Bacillus"[Organism]}{\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia"[Organism]+OR+"Bacillus"[Organism]}}} \\
  Recupera los registros de la base de datos \emph{nuccore} que corresponden a
  los microrganismos del género \textit{Escherichia} o del género 
  \textit{Bacillus}
\end{itemize}

\begin{table}
\small
\begin{center}
\begin{tabular}{llp{9cm}}
Field Name & Nombre completo &                                                                      Descripción \\ \hline
accn &           accession &                                                   Número de acceso de la secuencia \\
auth &              author &                                                          Autores de la publicación \\
 div &            division &                                                       División de la base de datos \\
fkey &         feature key &                                          \emph{Feature} anotado sobre la secuencia \\
gene &           gene name &                                            Nombre del gene asociado a la secuencia \\
 iss &               issue &                                Número de ejemplar (\emph{issue}) de la publicación \\
jour &             journal &                                         Abreviacíón de la nombre de la publicación \\
kywd &             keyword &                                             Palabras clave dadas por el publicante \\
mdat &   modification date &                                                    Fecha de la última modificación \\
orgn &            organism & Nombres científicos y comunes de los organismos, y de los niveles superiores de la clasificación taxonómica \\
pdat &    publication date &                                                      Fecha de publicación original \\
prop &          properties &             Clasificación por calificadores (\emph{qualifiers}) y tipo de molécula \\
slen &     sequence length &                                                           Longitud de la secuencia \\
titl &               title &                                           Contenido del título (\emph{definition}) \\
 uid &                 uid &                                             Número único asignado a cada secuencia \\
\end{tabular}
\end{center}
\normalsize{}
\caption{Campos de búsqueda de la base de datos \emph{nuccore} de NCBI}
\label{tab:ncbi_nuccore_fields}
\end{table}


Los parámetros \emph{retstart} y \emph{retmax} especifican las opciones de 
paginación de los resultados. El primero establece el índice del primer registro
a recuperar y el segundo la cantidad de registros a recuperar. El valor por 
omisión de \emph{retmax} es 20.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia+coli"[Organism]&retstart=0&retmax=100}
  {\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia+coli"[Organism]\&retstart=0\&retmax=100}}} \\
  Recupera los cien primeros registros que corresponden al microrganismo 
  \textit{Escherichia coli}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia+coli"[Organism]&retstart=100&retmax=100}
  {\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia+coli"[Organism]\&retstart=100\&retmax=100}}} \\
  Recupera los registros del 101 al 200, que corresponden al microrganismo 
  \textit{Escherichia coli}.
\end{itemize}

El parámetro \emph{rettype} define que información se va a devolver de la 
búsqueda. Solo acepta dos valores posibles, `uilist' y `count'. Con el primero, 
la opción por omisión, se devuelve una lista con los identificadores de los 
registros. La segunda devuelve el recuento de los registros.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia+coli"[Organism]&rettype=uilist}
  {\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia+coli"[Organism]\&rettype=uilist}}} \\
  Recupera la lista de los identificadores de registros.
  \textit{Escherichia coli}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=nuccore&term="Escherichia+coli"[Organism]&rettype=count}
  {\footnotesize{\texttt{esearch.fcgi?db=nuccore\&term="Escherichia+coli"[Organism]\&rettype=count}}} \\
  Recupera el número de resgistro coincidentes con la búsqueda.
  \textit{Escherichia coli}.
\end{itemize}

El parámetro \emph{retmode} especifíca el formato de respuesta: `xml'
o `json'. 

El parámetro \emph{reldate} permite limitar la búsqueda a los `n' días 
anteriores. Este parámetro requiere el uso del parámetro \emph{datetype}, que 
especifica que tipo de fecha se está buscando (por ejemplo, fecha de publicación o
fecha de última actualización). Los tipos de fechas disponibles es dependiente
de cada base de datos. Se pueden consultar con el sistema EInfo.

Los parámetros \emph{mindata} y \emph{maxdate}, permite la búsqueda de registro
en un rango determinado de fechas. También requiere el uso del parámetro 
\emph{datetype}.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=protein&term=egfr&reldate=60&datetype=pdat&retmax=100}
  {\footnotesize{\texttt{esearch.fcgi?db=protein\&term=egfr\&reldate=60\&datetype=pdat\&retmax=100}}} \\
  Recupera los identificadores de 100 registros de la base de datos \emph{protein}
  que contienen el término `egfr' (de \emph{epidermal growth factor rececetor})
  en alguno de los campos y hayan sido publicadas en los últimos 60 días. 
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esearch.fcgi?db=protein&term=egfr&datetype=mdat&mindate=2014&maxdate=2014}
  {\footnotesize{\texttt{esearch.fcgi?db=protein\&term=egfr\&datetype=mdat\&mindate=2014\&maxdate=2014}}} \\
  Recupera los identificadores de todos los registros de la base de datos 
  \emph{protein} que contienen el término `efgr' y cuya última actualización 
  haya sido durante el añoo 2014. 
  \textit{Escherichia coli}.
\end{itemize}

\subsubsection{ESummary}

La URL base es \url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi}.
La función de este servicio es la de proporcionar la información esencial de un
registro a modo de resumen. Esto evita tener que descargar el registro completo.
Usualmente, se lo utiliza como un paso secundario luego de usar el servicio 
ESearch.

Este servicio requiere de los parámetros \emph{db}, para especificar una base de
datos y \emph{id} para indicar de que registros se desea obtener información. Se
pueden especificar hasta 100 registros separando los identificadores con una coma.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=protein&id=894216091}
  {\footnotesize{\texttt{esummary.fcgi?db=protein\&id=894216091}}} \\
  Recupera el resumen del registro con el identificador 894216091 en la base de 
  datos \emph{protein}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/esummary.fcgi?db=protein&id=894216091,906849281,906849280}
  {\footnotesize{\texttt{esummary.fcgi?db=protein\&id=894216091,906849281,906849280}}} \\
  Recupera el resumen de los registros con los identificadores 894216091, 
  906849281 y 906849280, de la base de datos \emph{protein}.
  \textit{Escherichia coli}.
\end{itemize}

ESummary acepta los parámetros \emph{retstart}, \emph{retmax} y \emph{retmode} 
de la misma forma que ESearch.

\subsubsection{EFectch}
La URL base es \url{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi}.
La función de este servicio es la de descargar la información completa de un
registro de una base de datos a partir de su número de identificación. También 
suele usarse, luego de usar el servicio ESearch.

Al igual que ESummary requiere los parámetros \emph{db} y \emph{id} para 
especificar que registros se quiere obtener y de que base de datos.

Ejemplos:
\begin{itemize}
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=protein&id=894216091}
  {\footnotesize{\texttt{efetch.fcgi?db=protein\&id=894216091}}} \\
  Recupera el resumen del registro con el identificador 894216091 en la base de 
  datos \emph{protein}.
  \item \href{http://eutils.ncbi.nlm.nih.gov/entrez/eutils/efetch.fcgi?db=protein&id=894216091,906849281,906849280}
  {\footnotesize{\texttt{efetch.fcgi?db=protein\&id=894216091,906849281,906849280}}} \\
  Recupera el resumen de los registros con los identificadores 894216091, 
  906849281 y 906849280, de la base de datos \emph{protein}.
  \textit{Escherichia coli}.
\end{itemize}

Los parámtros \emph{rettype} y \emph{retmode} controlan que tipo de registro 
se quiere descargar y en que formato respectivamente. Los tipos y modos 
disponibles dependen de la base de datos en particular. En la tabla 
\ref{tab:NCBI_rettype_retmode_options} se muestran los tipos y modos 
para algunas de las bases de datos.

Es posible utilizar los parámetros \emph{retstart} y \emph{retmax}, para 
especificar una fracción de los resultados, al igual que en ESearch y ESummary.

El parámetro \emph{strand} permite recuperar, para registros que corresponden a
secuencias de molecula de DNA, una cadena específica. Hay dos valores 
permitidos: `1' para la cadena positiva (o sentido) y `2' para la cadena 
negativa (o antisentido). 

Los parámetros \emph{seq_start} y \emph{seq_start} define la región de la secuencia
que se desea recuperar. La primer base de la secuencia es la número `1'.

El parámetro \emph{complexity} permite recuperar los registros con diferentes
grados de complejidad. Los valores permitidos son números del `0' al `4', que
corresponden de mayor complejidad de los datos (`0') a menor complejidad (`4').
Esta opción no está disponible para todas las bases de datos.


  

\begin{table}[h!]
\begin{center}
\begin{tabular}{lll}
Tipo de registro                              & rettype       & retmode        \\ \arrayrulecolor{black}\hline
\multicolumn{3}{c}{All Databases}                                              \\
Document summary                              & docsum        & xml, default   \\
List of UIDs in XML                           & uilist        & xml            \\
List of UIDs in plain text                    & uilist        & text           \\ \arrayrulecolor[rgb]{.8,.8,.8}\hline
\multicolumn{3}{c}{Base de datos \emph{gene}}                                  \\
text ASN.1                                    & null          & asn.1, default \\
XML                                           & null          &xml             \\
Gene table                                    & gene\_table   &text            \\
Base de datos \emph{mesh}                                                      \\
Full record                                   & full, default & text, default  \\ \hline
\multicolumn{3}{c}{Bases de datos \emph{nuccore, nucest, nucgss, protein y popset}}   \\
ASN.1 texto                                   & null          & text, default  \\
ASN.1 binario                                 & null          & asn.1          \\
Full record in XML                            & native        & xml            \\
Accession number(s)                           & acc           & text           \\
FASTA                                         & fasta         & text           \\
TinySeq XML                                   & fasta         & xml            \\
SeqID string                                  & seqid         & text           \\ \hline
\multicolumn{3}{c}{Opciones adicionales para \emph{nuccore, nucest, nucgss y popset}} \\
GenBank flat file                             & gb            & text           \\
GBSeq XML                                     & gb            & xml            \\
INSDSeq XML                                   & gbc           & xml            \\ \hline
\multicolumn{3}{c}{Opciones adicionales para \emph{nuccore y protein}}         \\
Feature table                                 & ft            & text           \\ \hline
\multicolumn{3}{c}{Opciones adicionales para \emph{nuccore}}                   \\
GenBank flat file with full sequence (contigs)& gbwithparts   & text           \\
CDS nucleotide FASTA                          & fasta\_cds\_na  & text         \\
CDS protein FASTA                             & fasta\_cds\_aa  & text         \\ \hline
\multicolumn{3}{c}{Opciones adicionales para \emph{protein}}                   \\
GenPept flat file                             & gp            & text           \\
GBSeq XML                                     & gp            & xml            \\
INSDSeq XML                                   & gpc           & xml            \\
Identical Protein XML                         & ipg           & xml            \\ \hline
\multicolumn{3}{c}{Base de datos \emph{pubmed}}                                \\
text ASN.1                                    & null          & asn.1, default \\
XML                                           & null          & xml            \\
MEDLINE                                       & medline       & text           \\
PMID list                                     & uilist        & text           \\
Abstract                                      & abstract      & text           \\
\end{tabular}
\end{center}
\caption{Opciones para los parámetros \emph{rettype} y \emph{retmode} para el
servicio EFetch en NCBI. La lista que se muestra corresponde a un subconjunto
seleccionado de las bases de datos disponibles. Para obtener la referencia
completa se puede visitar \url{http://www.ncbi.nlm.nih.gov/books/NBK25499/table/chapter4.T._valid_values_of__retmode_and/?report=objectonly}}
\label{tab:NCBI_rettype_retmode_options}
\end{table}


% Go to:
% ELink
% Base URL
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi
% Functions
% 
%     Returns UIDs linked to an input set of UIDs in either the same or a different Entrez database
%     Returns UIDs linked to other UIDs in the same Entrez database that match an Entrez query
%     Checks for the existence of Entrez links for a set of UIDs within the same database
%     Lists the available links for a UID
%     Lists LinkOut URLs and attributes for a set of UIDs
%     Lists hyperlinks to primary LinkOut providers for a set of UIDs
%     Creates hyperlinks to the primary LinkOut provider for a single UID
% 
% Required Parameters
% db
% 
% Database from which to retrieve UIDs. The value must be a valid Entrez database name (default = pubmed). This is the destination database for the link operation.
% dbfrom
% 
% Database containing the input UIDs. The value must be a valid Entrez database name (default = pubmed). This is the origin database of the link operation. If db and dbfrom are set to the same database value, then ELink will return computational neighbors within that database. Please see the full list of Entrez links for available computational neighbors. Computational neighbors have linknames that begin with dbname_dbname (examples: protein_protein, pcassay_pcassay_activityneighbor).
% cmd
% 
% ELink command mode. The command mode specified which function ELink will perform. Some optional parameters only function for certain values of &cmd (see below).
% 
% cmd=neighbor (default)
% 
% ELink returns a set of UIDs in db linked to the input UIDs in dbfrom.
% 
% Example: Link from protein to gene
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=protein&db=gene&id=15718680,157427902
% 
% cmd=neighbor_score
% 
% ELink returns a set of UIDs within the same database as the input UIDs along with computed similarity scores.
% 
% Example: Find related articles to PMID 20210808
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&db=pubmed&id=20210808&cmd=neighbor_score
% 
% cmd=neighbor_history
% 
% ELink posts the output UIDs to the Entrez History server and returns a query_key and WebEnv corresponding to the location of the output set.
% 
% Example: Link from protein to gene and post the results on the Entrez History
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=protein&db=gene&id=15718680,157427902&cmd=neighbor_history
% 
% cmd=acheck
% 
% ELink lists all links available for a set of UIDs.
% 
% Example: List all possible links from two protein GIs
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=protein&id=15718680,157427902&cmd=acheck
% 
% Example: List all possible links from two protein GIs to PubMed
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=protein&db=pubmed&id=15718680,157427902&cmd=acheck
% 
% cmd=ncheck
% 
% ELink checks for the existence of links within the same database for a set of UIDs. These links are equivalent to setting db and dbfrom to the same value.
% 
% Example: Check whether two nuccore sequences have "related sequences" links.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=nuccore&id=21614549,219152114&cmd=ncheck
% ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
% cmd=lcheck
% 
% Elink checks for the existence of external links (LinkOuts) for a set of UIDs.
% 
% Example: Check whether two protein sequences have any LinkOut providers.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=protein&id=15718680,157427902&cmd=lcheck
% 
% cmd=llinks
% 
% For each input UID, ELink lists the URLs and attributes for the LinkOut providers that are not libraries.
% 
% Example: List the LinkOut URLs for non-library providers for two pubmed abstracts.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&id=19880848,19822630&cmd=llinks
% 
% cmd=llinkslib
% 
% For each input UID, ELink lists the URLs and attributes for all LinkOut providers including libraries.
% 
% Example: List all LinkOut URLs for two PubMed abstracts.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&id=19880848,19822630&cmd=llinkslib
% 
% cmd=prlinks
% 
% ELink lists the primary LinkOut provider for each input UID, or links directly to the LinkOut provider's web site for a single UID if retmode is set to ref.
% 
% Example: Find links to full text providers for two PubMed abstracts.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&id=19880848,19822630&cmd=prlinks
% 
% Example: Link directly to the full text for a PubMed abstract at the provider's web site.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&id=19880848&cmd=prlinks&retmode=ref
% Required Parameter - Used only when input is from a UID list
% id
% 
% UID list. Either a single UID or a comma-delimited list of UIDs may be provided. All of the UIDs must be from the database specified by dbfrom. There is no set maximum for the number of UIDs that can be passed to ELink, but if more than about 200 UIDs are to be provided, the request should be made using the HTTP POST method.
% 
% Link from protein to gene.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=protein&db=gene&id=15718680,157427902,119703751
% 
% Find related sequences (link from nuccore to nuccore).
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=nuccore&db=nuccore&id=34577062
% 
% If more than one id parameter is provided, ELink will perform a separate link operation for the set of UIDs specified by each id parameter. This effectively accomplishes "one-to-one" links and preserves the connection between the input and output UIDs.
% 
% Find one-to-one links from protein to gene.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=protein&db=gene&id=15718680&id=157427902&id=119703751
% Required Parameters - Used only when input is from the Entrez History server
% query_key
% 
% Query key. This integer specifies which of the UID lists attached to the given Web Environment will be used as input to ELink. Query keys are obtained from the output of previous ESearch, EPost or ELInk calls. The query_key parameter must be used in conjunction with WebEnv.
% WebEnv
% 
% Web Environment. This parameter specifies the Web Environment that contains the UID list to be provided as input to ELink. Usually this WebEnv value is obtained from the output of a previous ESearch, EPost or ELink call. The WebEnv parameter must be used in conjunction with query_key.
% 
% Link from protein to gene:
% elink.fcgi?dbfrom=protein&db=gene&query_key=<key>&WebEnv=<webenv string>
% 
% Find related sequences (link from protein to protein):
% elink.fcgi?dbfrom=protein&db=protein&query_key=<key>&WebEnv=
% <webenv string>
% 
% Optional Parameters - Limiting the Output Set of Links
% linkname
% 
% Name of the Entrez link to retrieve. Every link in Entrez is given a name of the form
% 
% dbfrom_db_subset.
% 
% The values of subset vary depending on the values of dbfrom and db. Many dbfrom/db combinations have no subset values. See the list of Entrez links for a listing of all available linknames. When linkname is used, only the links with that name will be retrieved.
% 
% The linkname parameter only functions when cmd is set to neighbor or neighbor_history.
% 
% Find all links from gene to snp.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=gene&db=snp&id=93986
% 
% Find snps with genotype data linked to genes.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=gene&db=snp&id=93986&linkname=gene_snp_genegenotype
% term
% 
% Entrez query used to limit the output set of linked UIDs. The query in the term parameter will be applied after the link operation, and only those UIDs matching the query will be returned by ELink. The term parameter only functions when db and dbfrom are set to the same database value.
% 
% Find all related articles for a PMID.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&db=pubmed&id=19879512
% 
% Find all related review articles published in 2008 for a PMID.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&db=pubmed&id=19879512&term=review%5Bfilter%5D+AND+2008%5Bpdat%5Dh
% holding
% 
% Name of LinkOut provider. Only URLs for the LinkOut provider specified by holding will be returned. The value provided to holding should be the abbreviation of the LinkOut provider's name found in the <NameAbbr> tag of the ELink XML output when cmd is set to llinks or llinkslib. The holding parameter only functions when cmd is set to llinks or llinkslib.
% 
% Find information for all LinkOut providers for a PMID.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&cmd=llinkslib&id=16210666
% 
% Find information from clinicaltrials.gov for a PMID.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/elink.fcgi?dbfrom=pubmed&cmd=llinkslib&id=16210666&holding=CTgov
% Optional Parameters - Dates
% 
% These parameters only function when cmd is set to neighbor or neighbor_history and dbfrom is pubmed.
% datetype
% 
% Type of date used to limit a link operation. The allowed values vary between Entrez databases, but common values are 'mdat' (modification date), 'pdat' (publication date) and 'edat' (Entrez date). Generally an Entrez database will have only two allowed values for datetype.
% reldate
% 
% When reldate is set to an integer n, ELink returns only those items that have a date specified by datetype within the last n days.
% mindate, maxdate
% 
% Date range used to limit a link operation by the date specified by datetype. These two parameters (mindate, maxdate) must be used together to specify an arbitrary date range. The general date format is YYYY/MM/DD, and these variants are also allowed: YYYY, YYYY/MM.
% Go to:
% EGQuery
% Base URL
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/egquery.fcgi
% Function
% 
% Provides the number of records retrieved in all Entrez databases by a single text query.
% Required Parameter
% term
% 
% Entrez text query. All special characters must be URL encoded. Spaces may be replaced by '+' signs. For very long queries (more than several hundred characters long), consider using an HTTP POST call. See the PubMed or Entrez help for information about search field descriptions and tags. Search fields and tags are database specific.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/egquery.fcgi?term=asthma
% Go to:
% ESpell
% Base URL
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/espell.fcgi
% Function
% 
% Provides spelling suggestions for terms within a single text query in a given database.
% Required Parameters
% db
% 
% Database to search. Value must be a valid Entrez database name (default = pubmed).
% term
% 
% Entrez text query. All special characters must be URL encoded. Spaces may be replaced by '+' signs. For very long queries (more than several hundred characters long), consider using an HTTP POST call. See the PubMed or Entrez help for information about search field descriptions and tags. Search fields and tags are database specific.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/espell.fcgi?db=pubmed&term=asthmaa+OR+alergies
% Go to:
% ECitMatch
% Base URL
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/ecitmatch.cgi
% Function
% 
% Retrieves PubMed IDs (PMIDs) that correspond to a set of input citation strings.
% Required Parameters
% db
% 
% Database to search. The only supported value is `pubmed'.
% rettype
% 
% Retrieval type. The only supported value is `xml'.
% bdata
% 
% Citation strings. Each input citation must be represented by a citation string in the following format:
% 
% journal_title|year|volume|first_page|author_name|your_key|
% 
% Multiple citation strings may be provided by separating the strings with a carriage return character (%0D). The your_key value is an arbitrary label provided by the user that may serve as a local identifier for the citation, and it will be included in the output. Be aware that all spaces must be replaced by `+' symbols and that citation strings should end with a final vertical bar `|'.
% 
% http://eutils.ncbi.nlm.nih.gov/entrez/eutils/ecitmatch.cgi?db=pubmed&retmode=xml&bdata=proc+natl+acad+sci+u+s+a|1991|88|3248|mann+bj|Art1|%0Dscience|1987|235|182|palmenberg+ac|Art2|
% Go to:
% Release Notes
% ESearch &sort; JSON output format: February 14, 2014
% 
%     ESearch now provides a supported sort parameter
%     EInfo, ESearch and ESummary now provide output data in JSON format
% 
% ECitMatch, EInfo Version 2.0, EFetch: August 9, 2013
% 
%     ECitMatch is a new E-utility that serves as an API to the PubMed batch citation matcher
%     EInfo has an updated XML output that includes two new fields: <IsTruncatable> and <IsRangeable>
%     EFetch now supports the BioProject database.
% 
% EFetch Version 2.0. Target release date: February 15, 2012
% 
%     EFetch now supports the following databases: biosample, biosystems and sra
%     EFetch now has defined default values for &retmode and &rettype for all supported databases (please see Table 1 for all supported values of these parameters)
%     EFetch no longer supports &retmode=html; requests containing &retmode=html will return data using the default &retmode value for the specified database (&db)
%     EFetch requests including &rettype=docsum return XML data equivalent to ESummary output
% 
% Release of new Genome database: November 9, 2011
% 
%     Entrez Genome has been completely redesigned, and database records now correspond to a species rather than an individual chromosome sequence. Please see full details of the change at www.ncbi.nlm.nih.gov/About/news/17Nov2011.html
%     Old Genome IDs are no longer valid. A file is available on the NCBI FTP site that maps old Genome IDs to Nucleotide GIs: ftp.ncbi.nih.gov/genomes/old_genomeID2nucGI
%     EFetch no longer supports retrievals from Genome (db=genome).
%     The ESummary XML for Genome has been recast to reflect the new data model.
%     To view the new search fields and links supported for the new Genome database, please see http://eutils.ncbi.nlm.nih.gov/entrez/eutils/einfo.fcgi?db=genome 
% 
% ESummary Version 2.0. November 4, 2011
% 
%     ESummary now supports a new, alternative XML presentation for Entrez document summaries (DocSums). The new XML is unique to each Entrez database and generally contains more extensive data about the record than the original DocSum XML.
%     There are no plans at present to discontinue the original DocSum XML, so developers can continue to use this presentation, which will remain the default.
%     Version 2.0 XML is returned when &version=2.0 is included in the ESummary URL.

\subsection{European Nucleotide Archive - ENA}
La base de datos ENA ofrece varios servicios para la búsqueda y descarga de 
registros programaticamente usando una interface REST. Además da acceso FTP para
descargar sus datos.

De todos los servicios que ofrece, se discutirán el servicio de recuperación de
datos, el de búsqueda por texto y el acceso por FTP.

\subsubsection{Recuperación de datos - \textit{Data retrieval}}
La URL base de este servicio es '\url{http://www.ebi.ac.uk/ena/data/view/}'.
El uso más sencillo es la búsqueda por el código de identificación del
registro que se quiere recuperar. Por ejemplo, la búsqueda
'\url{http://www.ebi.ac.uk/ena/data/view/KP718916}, recupera el registro
`KP718916'. Es posible, la búsqueda por rango separando dos códigos de
identificación con el símbolo `-'.

Otra opción, es la búsqueda por nombre taxonómico. Este tipo de búsqueda acepta
nombres comunes, nombres científicos y números de identificación de taxa.
En este tipo de búsqueda la URL base es
'\url{http://www.ebi.ac.uk/ena/data/view/Taxon:}' Por ejemplo, la búsquedas que
se muestra debajo recuperan los registros asociados a una especie de laucha.
\begin{itemize}
  \item \url{http://www.ebi.ac.uk/ena/data/view/Taxon:calomys laucha}
  \item \url{http://www.ebi.ac.uk/ena/data/view/Taxon:small vesper mouse}
  \item \url{http://www.ebi.ac.uk/ena/data/view/Taxon:56211}
\end{itemize}

Además, es posible obtener información acerca de proyectos de secuenciación.
Para ello, se necesita el número de identificación del proyecto (project\_id) o
el código de acceso del estudio (study\_accession). La URL para estas búsquedas
se muestran debajo.
\begin{itemize}
  \item http://www.ebi.ac.uk/ena/data/view/study\_accession
  \item Ejemplo: \url{http://www.ebi.ac.uk/ena/data/view/PRJDB1793}
  \item http://www.ebi.ac.uk/ena/data/view/Project:project\_id
  \item Ejemplo: \url{http://www.ebi.ac.uk/ena/data/view/Project:254551}
\end{itemize}

El formato de descarga de los datos es por omisión HTML, sin embargo, esta no 
es la mejor opción si se desea hacer consulta programáticas. ENA ofrece otros
formatos para descargar los datos. Para ello, se utiliza la opción 
\emph{display} en el URL de búsqueda. En la tabla \ref{tab:ena_fmt} se muestran
los formatos aceptados.

\begin{table}[!h]
\begin{center}
\small{}
\begin{tabular}{lp{5cm}p{7cm}}
Opción & Descripción & Ejemplo \\ \hline
html   & Valor por omisión. Muestra los resultados en formato html. Disponible
para todos los tipos de datos &
\url{http://www.ebi.ac.uk/ena/data/view/KP718916&display=html} \\
xml    & Muestra los resultados en formato Xml. Disponible para todos los tipos
de datos & \url{http://www.ebi.ac.uk/ena/data/view/KP718916&display=xml} \\
text   & Muestra los datos en formato de texto plano. Disponible solo para
secuencias con anotación y ensambladas &
\url{http://www.ebi.ac.uk/ena/data/view/KP718916&display=text} \\
fasta  & Muestra los datos en formato fasta. Disponible solo para
secuencias con anotación, ensambladas y \textit{trace} & 
\url{http://www.ebi.ac.uk/ena/data/view/KP718916&display=fasta} \\ 
fastq  & Muestra los datos en formato fastq. Solo disponible para \textit{trace}
& \url{http://www.ebi.ac.uk/ena/data/view/TI1&display=fastq} \\
\end{tabular}
\normalsize{}
\end{center}
\caption{Formatos disponibles en ENA}
\label{tab:ena_fmt}
\end{table}

Además de poder especificar el formato del contenido, se puede definir si se
desea que la descarga sea un archivo de texto plano o un archivo comprimido.
Para ello, se usa la opción \emph{download}. Los valores permitidos son
\emph{txt} y \emph{gzip}.

Este sistema de descarga limita la cantidad de descargas a 100 000 registros por
consulta. Este límite es para evitar la descarga no intencional de un gran
cantidad de datos. Si, es necesario descargar más registros se utiliza la 
opción \emph{lentgh}, cuyo valor es el nuevo número de límite que se desea. Otra
opción importante es \emph{offset} que establece cual es el primer registro que
se descargará. Esto es útil para hacer descargar fragmentadas.

\subsubsection{Búsqueda por texto}
La búsqueda por texto en ENA usa la URL base \url{http://www.ebi.ac.uk/ena/data/warehouse/search}.
La búsqueda se realiza en particiones de las bases de datos denominadas \emph{domain} 
y \emph{result}. La partición \emph{domain} es de mayor nivel de abstracción y 
divide el contenido según su naturaleza. La partición \emph{result} es un 
refinamiento de \emph{domain} que divide la información con algún criterio
adiocional. Por ejemplo, el \emph{domain} `sequence' agrupa los registros que 
contiene información de secuencias nucleotídicas. Para este \emph{domain} hay
dos \emph{result} disponibles: `sequence\_release'  y `sequence\_update'. El 
primero contiene todas las secuencias de la última versión publicada de la
base de datos y el segundo tiene las secuencias que se agregaron o actualizaron
desde esa última publicación. Este último conjunto suele ser mucho más pequeño.
En la tabla \ref{tab:ena_domains_and_results} se muestran todos los \emph{domain} 
y \emph{result} disponibles. 

\begin{table}
\begin{center}
\begin{tabular}{llp{7cm}}
       Domain &             Result &                                                Descripción \\ \hline
     assembly &           assembly &                                        Genomas ensamblados \\
     sequence &  sequence\_release &                        Secuencias de nucleótidos (release) \\
     sequence &   sequence\_update &                         Secuencias de nucleótidos (Update) \\
       coding &    coding\_release &                          Secuencias codificantes (Release) \\
       coding &     coding\_update &                           Secuencias codificantes (Update) \\
    noncoding & noncoding\_release &                       Secuencias no codificantes (Release) \\
    noncoding &  noncoding\_update &                        Secuencias no codificantes (Update) \\
         read &   read\_experiment &                  Lecturas crudas agrupadas por experimento \\
         read &          read\_run &                                            Lecturas crudas \\
         read &        read\_study &            Lecturas crudas agrupadas agrupadas por estudio \\
     analysis &           analysis & Análisis de secuencias de nucleótidos a partir de lecturas \\
     analysis &    analysis\_study & Análisis de secuencias de nucleótidos a partir de lecturas, agrupados por estudio \\
        trace &        read\_trace &                                        Trazas de capilares \\
        study &              study &                                                   Estudios \\
        taxon &              taxon &                                   Clasificación taxonómica \\
       sample &             sample &                                                   Muestras \\
environmental &      environmental &                                       Muestras ambientales \\
\end{tabular}
\end{center}
\caption{Particiones \emph{domain} y \emph{result} disponibles en ENA.}
\label{tab:ena_domains_and_results}
\end{table}

Las búsqueda programáticas por texto, además del parámetro URL \emph{query},
requieren de los parámetros \emph{domain} y \emph{result}. El contenido del 
parámetro \emph{query} no es libre, es decir no es posible hacer una búsqueda 
arbitraria de texto. El contenido del parámetro se construye por opciones de 
filtrado unidos por operadores lógicos (\emph{AND}, \emph{OR}, \emph{NOT})). 
Si se tienen varias opciones de filtrado, se pueden agrupar entre paréntesis.

Las opciones de filtrado se aplican a los distintos campos que posee cada 
registro. Los campos disponibles varian en cada \emph{domain} y \emph{result}.
También, cada campo de búsqueda tienen valores de un tipo particular: \emph{booleano},
\emph{Vocabulario restringido}, \emph{fecha}, \emph{númerico}, \emph{textual},
\emph{geo-espacial} y \emph{taxonómico}. En la tabla \ref{tab:ena_search_fields}
se muestran algunos de los campos de búsqueda más comunes para el \emph{domain=sequence}
y \emph{result=sequence\_release}. Estos campos se comparan con operadores de 
igualdad (`='), diferencia (`!='), mayor y menor (`>', `>=', `<=' y `<'), excepto
los campos de ubicación geográfica y taxonomía. La búsqueda por estos campos
requiere el uso de funciones particulares. En la tabla \ref{tab:ena_search_loc_and_taxon}
se muestran algunas funciones que provee ENA para este tipo de búsqueda.

\begin{table}[h!]
\begin{center}
\small
\begin{tabular}{lp{5cm}p{4cm}l}
Función   & Descripción & Parámetros & Ejemplo \\ \hline
geo\_box1 & La ubicación se encuentra dentro de un cuadrado definido por la 
            esquina superior derecha y la esquina inferior izquierda                              
          & latitud suroeste, longitud suroeste, latitud noreste y longitud 
            noreste
          & geo\_box1(-20,10,20,50)\\
geo\_circ & La unicación se encuentra dentro de un circulo definido por el 
            centro y el radio 
          & Latitud, longitud y radio (km) 
          & geo\_circ(44,00,00) \\
tax\_eq    & Registros que coinciden con un identificador de taxonomía del NCBI 
          & Identificador de taxonomía de NCBI(numérico) 
          & tax\_eq(9606) \\
tax\_tree  & Registros que coinciden con un identificador de taxonomía del NCBI y
            todos sus descendientes. 
          & Identificador de taxonomía de NCBI(numérico) 
          & tax\_tree(2759) \\
\end{tabular}
\normalsize{}
\end{center}
\caption{Funciones para la búsqueda por geolocalización y por taxonomía}
\label{tab:ena_search_loc_and_taxon}
\end{table}

\begin{table}[h!]
\begin{center}
\small{}
\begin{tabular}{lp{3cm}p{7cm}}
            accession &                   Texto &                                         Número de acceso \\ \hline
          base\_count &                  Número &                                Longitud de la secuencias \\
           cell\_line &                   Texto &              línea celular de donde se obtuvo la muestra \\
              country &                   Texto &        Ubicación de la muestra: País, región y localidad \\
          description &                   Texto &                        Breve descripción de la secuencia \\
environmental\_sample &                Booleano &  Especifíca si el material pertenece a muestra ambiental \\
             keywords &                   Texto &                  Palabras clave asociadas a la secuencia \\
        last\_updated &                   Fecha &                         Fecha de la última actualización \\
%             location &      Latitud y longitud &  Ubicación geográfica de punto aislamiento de la muestra \\
            mol\_type & Vocabulario restringido &           Tipo molecular de la molécula \textit{in vivo} \\
\end{tabular}
\normalsize{}
\end{center}
\caption{Lista de algunos de los campos de búsqueda ofrecidos por ENA.}
\label{tab:ena_search_fields}
\end{table}

La búsqueda por texto ofrece las mismas opciones para manipular el formato de 
los datos a recibir que la búsqueda por identificador que se discutió en la 
primer sección. Se usan los parámetros \emph{display}, \emph{download}, \emph{length}
y \emph{offset} ya vistos (ver la tabla \ref{tab:ena_fmt}). Este tipo de búsqueda
ofrece una opción más para el parámetro \emph{display}, el valor `report'. Esta 
opción permite descargar algunos campos de los registros y no el registro completo.
Es útil para tener en un resumen de los registros que se desea descargar. Cuando
se usa esta opción se requiere el uso del parámetro \emph{fields} para indicar 
los campos que se desea obtener. Debajo se muestran 
algunos de los campo más usuales para el \emph{domain} `sequence' y \emph{result}
`sequence\_release'.

\begin{multicols}{3}
\begin{itemize}
  \item accession
  \item base\_count
  \item cell\_line
  \item description
  \item environmental\_sample
  \item host 
  \item keywords 
  \item last\_updated 
  \item location 
  \item mol\_type 
  \item tax\_division
  \item tax\_id 
  \item scientific\_name
\end{itemize}
\end{multicols}

La referencia completa de los campos de búsqueda y los campos disponibles para 
los reportes se puede consultar en \url{http://www.ebi.ac.uk/ena/data/warehouse/usage}.

\subsubsection{Formato del registro}
\scriptsize{}
\begin{verbatim}
ID   AJ131281; SV 1; linear; genomic RNA; STD; VRL; 348 BP.
XX
AC   AJ131281;
XX
DT   03-DEC-1998 (Rel. 57, Created)
DT   10-DEC-1999 (Rel. 62, Last updated, Version 2)
XX
DE   Lymphocytic choriomeningitis virus z gene, partial, strain MX
XX
KW   RING finger protein; z gene.
XX
OS   Lymphocytic choriomeningitis mammarenavirus
OC   Viruses; ssRNA viruses; ssRNA negative-strand viruses; Arenaviridae;
OC   Mammarenavirus.
XX
RN   [1]
RP   1-348
RA   Pastorek J.;
RT   ;
RL   Submitted (02-DEC-1998) to the INSDC.
RL   Pastorek J., Molecular Biology, Institute of Virology, Slovak Academy of
RL   Sciences, Dubravska cesta 9, 842 46, SLOVAK REPUBLIC.
...
XX
DR   MD5; 520554560ea4a63dc1fe3f175b37a319.
XX
FH   Key             Location/Qualifiers
FH
FT   source          1..348
FT                   /organism="Lymphocytic choriomeningitis mammarenavirus"
FT                   /lab_host="HeLa cells"
FT                   /strain="MX"
FT                   /mol_type="genomic RNA"
FT                   /db_xref="taxon:11623"
FT   CDS             <70..343
FT                   /codon_start=2
FT                   /gene="z"
FT                   /product="ring finger protein"
...
FT                   /experiment="experimental evidence, no additional details
FT                   recorded"
FT                   /protein_id="CAA10342.1"
FT                   /translation="MGQGKSKEKKDTNTGDRAEILPDTTYLGPLNCKSCWQKFDSLVRC
FT                   HDHYLCRHCLNLLLSVSDRCPLCKCPLPTKLKISTAPSPPPPYEE"
FT   mat_peptide     <70..338
FT                   /gene="z"
FT                   /product="ring finger protein"
XX
SQ   Sequence 348 BP; 95 A; 100 C; 77 G; 76 T; 0 other;
     cgtttagttg cgctgtttgg ttgaacagcc ttttcctgtg agagtacaga gacaaaccta        60
...
     gatatcaaca gccccaagcc caccacctcc ctacgaagag taacaccg                    348
//
\end{verbatim}
\normalsize{}
\subsection{DNA Data Bank of Japan - DDBJ}
La base de datos DDBJ ofrece, además de la interfaz web, el acceso por FTP y
una API web llamada WABI (Web API for Biology). Estos dos son los recursos que
permiten el acceso programático a esta base de datos.

\subsubsection{Formato del registro}
\scriptsize{}
\begin{verbatim} 
LOCUS       AJ131281                 348 bp    RNA     linear   VRL 10-DEC-1999
DEFINITION  Lymphocytic choriomeningitis virus z gene, partial, strain MX.
ACCESSION   AJ131281
VERSION     AJ131281.1  GI:3970751
KEYWORDS    RING finger protein; z gene.
SOURCE      Lymphocytic choriomeningitis mammarenavirus (LCMV)
  ORGANISM  Lymphocytic choriomeningitis mammarenavirus
            Viruses; ssRNA viruses; ssRNA negative-strand viruses;
            Arenaviridae; Mammarenavirus.
REFERENCE   1
  AUTHORS   Gibadulinova,A., Zelnik,V., Reiserova,L., Zavodska,E.,
            Zatovicova,M., Ciampor,F., Pastorekova,S. and Pastorek,J.
  TITLE     Sequence and characterisation of the Z gene encoding ring finger
            protein of the lymphocytic choriomeningitis virus MX strain
  JOURNAL   Acta Virol. 42 (6), 369-374 (1998)
   PUBMED   10358742
REFERENCE   2  (bases 1 to 348)
  AUTHORS   Pastorek,J.
  TITLE     Direct Submission
  JOURNAL   Submitted (02-DEC-1998) Pastorek J., Molecular Biology, Institute
            of Virology, Slovak Academy of Sciences, Dubravska cesta 9, 842 46,
            SLOVAK REPUBLIC
FEATURES             Location/Qualifiers
     source          1..348
                     /organism="Lymphocytic choriomeningitis mammarenavirus"
                     /mol_type="genomic RNA"
                     /strain="MX"
                     /db_xref="taxon:11623"
                     /lab_host="HeLa cells"
     gene            <70..343
                     /gene="z"
     CDS             <70..343
                     /gene="z"
                     /experiment="experimental evidence, no additional details
                     recorded"
                     /codon_start=2
                     /product="ring finger protein"
                     /protein_id="CAA10342.1"
                     /db_xref="GI:3970752"
                     /translation="MGQGKSKEKKDTNTGDRAEILPDTTYLGPLNCKSCWQKFDSLVR
                     CHDHYLCRHCLNLLLSVSDRCPLCKCPLPTKLKISTAPSPPPPYEE"
     mat_peptide     <70..338
                     /gene="z"
                     /product="ring finger protein"
ORIGIN      
        1 cgtttagttg cgctgtttgg ttgaacagcc ttttcctgtg agagtacaga gacaaaccta
 ...
      301 gatatcaaca gccccaagcc caccacctcc ctacgaagag taacaccg
//
\end{verbatim}
\normalsize{}
\subsubsection{Acceso FTP}
DDBJ permite descargas varias bases de datos. Nos enfocaremos en \emph{DDBJ}
(nucleotidos), \emph{DAD} (aminoácidos) y \emph{wgs} (secuenciación de genomas
completos). 
La URL base para ellas son:
\begin{description}
  \item[ddbj] \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/ddbj}
  \item[ddbj - release notes]
  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/release_note_archive/ddbj}
  \item[dad]  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/dad}
  \item[dad - release notes] 
  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/release_note_archive/dad}
  \item[wgs]  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/wgs}
  \item[wgs - Lista de organismos]
  \url{ftp://ftp.ddbj.nig.ac.jp/ddbj_database/wgs/WGS_ORGANISM_LIST.txt}
\end{description}

La información en las bases de datos \emph{ddbj} y \emph{dad} está organizada
en diferentes categorías, según el origen de las secuencias. Los archivos de 
datos que pueden ser descargados se corresponden con estas categorías y siguen
una nomenclatura racional. En la tabla \ref{ddbj_ftp_categories} se detallan las
categorías. El nombre de cada archivo está formado por un prefijo que 
corresponde con alguna de las categorías, después un número de orden creciente y
finalmente la extensión. El formato de los archivos es texto plano, comprimido.
Para las bases de datos \emph{ddbj} y \emph{dad}, posible descargar archivos en 
formato \texttt{fasta} y \texttt{XML}. Estos se encuentran en las
subcarpetas \texttt{fasta/} y \texttt{xml/insdxml/v1.4} respectivamente.

\begin{table}[h!tp]
\begin{center}
\begin{tabular}{llp{11cm}}
Categoría  & Prefijo & Descripción \\ \hline
HUM        & ddbjhum & Humano \\
PRI        & ddbjpri & Primates (no humano) \\
ROD        & ddbjrod & Roedores \\
MAM        & ddbjmam & Mamiferos (no primates, ni roedores) \\
VRT        & ddbjvrt & Vertebrados (no mamíferos) \\
INV        & ddbjinv & Invertebrados \\
PLN        & ddbjpln & Plantas, hongos, plastidos y otros eukariotas \\
BCT        & ddbjbct & Bacterias y archaeas \\
VRL        & ddbjvrl & Viruses \\
PHG        & ddbjphg & Bacteriofagos \\
ENV        & ddbjenv & Secuencias de muestras ambientales \\
SYN        & ddbjsyn & Secuencias de cosntrucciones sintéticas \\
EST        & ddbjest & \textit{Expressed sequence tags}. Secuencias cortas
                       de cDNA \\
GSS        & ddbjgss & \textit{Genome survey sequences}. Secuencias
                       genómicas cortas \\
TSA        & ddbjtsa & Ensamblados de transcriptómica (\textit{Transcriptome
                       shhotgun assemblies}) \\
HTC        & ddbjhtc & Secuencias de cDNA por métodos de alto rendimiento
                       (\emph{high throughput} .
                       Esta categoría incluye secuencias de cDNA no terminadas.
                       Cuando la secuenciación se completa se mueve a la 
                       categoría taxonómica que le corresponde \\
HTG        & ddbjhtg & Secuencias genómicas por métodos de alto rendimiento
                       (\emph{high throughput}) \\
STS        & ddbjsts & \emph{Sequence tagged sites} \\
PAT        & ddbjpat & Secuencias relacionadas con aplicaciones patentadas \\
UNA        & ddbjuna & Secuencias no anotadas. \\
CON        & ddbjcon & Rearmados en proyectos de secuenciación (Contigs) \\
\end{tabular}
\end{center}
\caption{Categorías de las bases de datos de DDBJ}
\label{ddbj_ftp_categories}
\end{table}


\subsubsection{Acceso por Web API}
DDBJ ofrece API para tres servicios diferentes. El servicio WABI BLAST, que 
permite la búsqueda usando Blast. El servicio 'getentry WebAPI' que permite la
recuperar registros de la base de dato por número de acceso y el servicio ARSA 
WebAPI, que permite la búsqueda de registros por su contenido textual (no de 
secuencia. Los tres servicios usan una arquitectura REST 
(\textit{Representational state transfer}) sobre http para las consultas. 



\subsubsection{Getentry WebAPI}
El servicio getentry permite recuperar registro de una de las bases de data de 
DDBJ por su número de acceso. Las consultas se pueden hacer mediante el método
HTML GET o usando una URL semántica. En ambos casos, la URL base es la misma:
'\url{http://getentry.ddbj.nig.ac.jp/getentry}'. La síntaxis para especificar 
una consulta usando el método GET es '\url{http://getentry.ddbj.nig.ac.jp/getentry?database=nombre_de_la_base_de_datos&accession_number=número_de_acceso}' \\
por ejemplo, la consulta '\url{http://getentry.ddbj.nig.ac.jp/getentry?database=ddbj&accession_number=KP177965}' \\
recupera el registro con el número de acceso KP177965. 
La síntaxis para hacer una consulta mediante una URL semántica
La misma consulta, usando
una URL semántica es
'\url{http://getentry.ddbj.nig.ac.jp/getentry/nombre_de_la_base_de_datos/número_de_acceso/revision},
donde 'revisión' es opcional. Los registros pueden ser actualizados en el 
tiempo, cada nueva versión de un registro se carateriza por la fecha y hora de
la actualización. Por ejemplo, la
'\url{http://getentry.ddbj.nig.ac.jp/getentry/ddbj/AY646354/2010-02-26+14:07:01}'
\\ recupera la revisión 2010-02-26 14:07:01 del registro. Para saber que 
revisiones están disponibles para un registro particular se puese hacer una
consulta a la '\url{http://getentry.ddbj.nig.ac.jp/gethistory}', con un formato
similar a la de 'getentry'.

Los parámetros disponibles para las consultas son el \emph{número de acceso},
\emph{base de datos}, \emph{revisión}, \emph{formato}, \emph{tipo de archivo},
\emph{mostrar eliminados} y \emph{limite}.


Para especificar el número se acceso se utiliza la palabla clave
\emph{accession\_number}. Se puede indicar el número de acceso solo (ej.
AY646354), o el número de versión (AY646354.1). Se puede especificar varios 
número de acceso en un sola consulta, separándolos con una coma. También se 
puede indicar un rango de números de acceso, conectando dos número de accesos
con un símbolo '-'. Este parámetros es el único obligatorio.

Para especificar una base de datos se usa la palabra clave \emph{database}.
Las báses de datos disponibles se muestran en la tabla \ref{tab:getentry_dbs}

\begin{table}
\begin{center}
\begin{tabular}{llp{7cm}}
Tipo    & Base de datos & Descripción\\ \hline
DNA     & na            & Busca en todas las bases de datos dispoibles. Es la
                          opción usada por defecto. \\
        & ddbj          & Base de datos propioa de DDBJ. \\
        & wgs           & Base de datos de proyectos de secuenciación de
                          genomas completos (Whole genome sequences). \\
        & mga           & Secuenciación masiva para anotación genómica (Mass
                          sequence for Genome Annotation. \\ \hline
Protein & aa            & Busca en todas las bases de datos disponibles. \\
        & uniprot       & Base de datos Uniprot.\\
        & dad           & Secuencias de aminoácidos de DDBJ. \\
        & patent\_aa    & Secuencias derivadas de patentes. 

El código de revisión se especifica con la palabra clave \emph{revision} y 
consiste en la fecha y la hora con el formato \ttfamily{yyyy-MM-dd hh:mm:ss} o
\ttfamily{yyyy-MM-dd hh:mm:ss release}.

\end{tabular}
\end{center}
\caption{Bases de datos disponibles en \emph{gententry}}
\label{tab:getentry_dbs}
\end{table}

Para especificar el formato de retorno de los datos se utiliza la palabra clave
\emph{format}. En la tabla \ref{tab:getentry_fmts} se muestran los posibles 
valores que puede tomar.

\begin{table}
\begin{center}
\begin{tabular}{ll}
Formato  & Descripción             \\ \hline
flatfile & Formato de texto plano \\
xml      & Formato INSDSeq-XML     \\
fasta    & Secuencias de DNA o proteína en formato fasta \\
trans    & Secuencia codificante traducida a proteínas (fasta) \\
cds      & Secuencia codificante en nucleótidos (fasta)
\end{tabular}
\end{center}
\caption{Formatos de retorno de \emph{getentry}.}
\label{tab:getentry_fmts}
\end{table}

Para especificar que tipo de archivo en que se quiere recuperar los datos se 
usa la palabra clave \emph{filetype}. Los valores posibles son \emph{html}, 
\emph{text} y \emph{gz} (texto plano comprimido).

Es posible recuperar información de registro viejos y que fueron eliminados de
las versiones más recientes de las bases de datos. Para ello, se debe usar la
palabra clave \emph{show\_suppressed}. Los valores posibles son \emph{true} y 
\emph{false}. El valor por defecto es \emph{false}.

Para limitar la cantidad de resultados que se desea recuperar se utiliza el
parámetros \emph{limit}. Cuyo valor es el número máximo de registro que se 
puede recuperar. El valor por defecto es 10. Si se especifica 0, se repueran
todos los registros disponibles.


\subsubsection{ARSA WebAPI.} Está diseñada para ser usada con un navegador web. Los
navegadores compatibles son Firefox y Chrome, IE versiones 9 y 10; y Safari
version 5 y posteriores.

Arsa recupera información de las siguientes bases de datos:
\begin{itemize}
  \item DDBJ Release
  \item DDBJ New (daily updates)
  \item Amino Acid Patent Sequence data submitted from JPO
  \item Amino Acid Patent Sequence data submitted from KIPO.
\end{itemize}

La URL base para la búsqueda es '\url{http://ddbj.nig.ac.jp/arsa/search}'. Los 
resultados pueden ser recuperados en idioma inglés o japonés. Para definir el
idioma es necesario agregar a la dirección base el el capo 'lang' con valor 
'en'. De esta forma la URL se convierte en: 
\url{http://ddbj.nig.ac.jp/arsa/search?lang=en}. El formato de respuesta es HTML,
porque está pensado para ser mostrado en un navegador como una página web.
Si se desea, obtener esta información en un formato que pueda ser fácilmente 
manipulado se tienen dos opciones. Ambas implican usar una URL base diferente. 
Una de las opciones es descargar el contenido de todos los registros en formato
plano, para ello, hay que cambiar a la URL '\url{http://ddbj.nig.ac.jp/arsa/downloadAll?lang=en}'.
La otra opción es recuperar los identificadores de cada registro y luego 
descargar cada uno de ellos, invididualmente con el servicio 'getentry', para 
ello, se debe cambiar la URL base a '\url{http://ddbj.nig.ac.jp/arsa/searchAllIds?lang=en}'. 

Hay dos condiciones de búsqueda, la búsqueda rápida (\textit{Quick Search}) y la
búsqueda avanzada (\textit{Advanced Search}). La condición de búsqueda se define
en el campo 'cond', sus posibles valores son: 'quick\_search' y 'advanced\_search'.
Sin embargo, en esta guía se trabajará solamente con la condición de búsqueda 
simple. El campo 'query' define el texto que se desea buscar. Existen varios opciones
para refinar la búsqueda. Los valores que corresponden a valores booleanos
('AND', 'OR', 'NOT') deben ser escritos en mayúsculas. Para separar dos o más
palabras, en lugar de usar un espacio, se debe usar el signo '+'. 

Las opciones de la búsqueda rápida son las siguientes:
\begin{description}
  \item[Coincidencia por conjunción] Búsquedas que contienen todas las palabras clave 
  dadas. Se debe usar el campo 'operator' con el valor 'AND'. Por ejemplo, la
  búsqueda '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=brain+phosphatidylethanolamine&operator=AND}'\\  
  recupera todos los registros que contienen las palabras 'brain' y
  'phosphatidylethanolamine', aunque se encuentren en lugares diferentes en el
  registro. El primer resultado de la búsqueda del ejemplo es un registro que
  contiene la palabra 'brain' en la definición del registro (título principal)
  y la palabra 'phosphatidylethanolamine' en el título de una de las referencias
  bibliográficas que aparecen en ese registro.
  \item[Coincidencia por disyunción] Búsquedas que contienen al menos una de 
  las palabras clave dadas. Se indican en el campo 'operator' y con el valor 
  'OR'. Por ejemplo, la búsqueda '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=tinea+versicolor&operator=OR}'\\
  recupera registros de 'Tinea versicolor', 'Trametes versicolor' y 'Tinea pellionella'.
  \item[Negación] Búsquedas que contienen una o más palabras clave y que carecen
  de otras que son dadas explicitamente. Se indican con la palabra clave 'NOT'
  dentro del campo 'query', la palabra clave que se encuentra  a su derecha es 
  la que debe estar ausente. Por ejemplo, la búsqueda
  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=homo+NOT+sapiens&operator=AND}'\\
  recupera los registros que contiene la palabros 'homo' pero no 'sapiens'.
  \item[Coincidencia parcial] Búsquedas que contienen parte de una palabra. Se
  indica en el campo 'query'. Al final del término buscado se agrega el
  símbolo '*'. Por ejemplo, la búsqueda '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=candid*}'\\
  recupera registros de '\textit{Candida dubliniensis}', '\textit{Candidatus Phytoplasma}',
  'Junin virus strain candid1', entre otros.
  \item[Coincidencia de frases] Búsquedas que contienen varios términos en el orden
  dado. Se indican encerrando entre comillas los términos. Dependiendo de la 
  herramienta que se utilice, puede ser necesario reemplazar
  las comillas por '\%22'. Por ejemplo, la búsqueda 
  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=%22mouse+brain%22&operator=AND
  }'\\
  recupera los registro que contengan la frase 'mouse brain'.
  \item[Búsquedas en campos] Búsquedas que deben coincidir en un campo 
  particular del registro. Se indican nombrando el campo en el que se debe 
  hacer la búsqueda antes de la palabra clave buscada y separados por el 
  símbolo ':' (o su código de escape '\%3A'). Por ejemplo, la búsqueda
  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=df:``homo+sapiens"&operator=AND}' \\
  recupera registros que tienen la frase 'homo sapiens' en su definición (título principal).
  \item[Búsqueda por expresiones regulares] Algúnas búsquedas en campos permiten
  usar expresiones regulares. Deben encerrarse con el símbolo '/' (o '\%2F'). 
  En la tabla \ref{DDBJ_ARSA_regex} se muestran las expresiones regulares 
  permitidas.
  \item[Búsqueda por rango de valores] Algunas búsquedas en campos permiten 
  indicar un rango de valores para la coincidencia. Deben encerrarse entre 
  corchetes. La palabra clave 'TO' debe estar presente entre el valor
  mínimo y el máximo del rango. Se puede usar el símbolo '*' para indicar un 
  valor de inicio o final del rango desconocido. Por ejemplo, la búsqueda 
  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=pa:[GL000000+TO+GL000010]&operator=AND}' \\
  recupera los registros existentes cuyo número de acceso primario sea 
  'GL000001', 'GL000002',  \ldots y 'GL000010'. Otro ejemplo,  '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=sl:[0+TO+100]&operator=AND}' \\
  recupera todos los registros cuya longitud de secuencia sea 100 o menos.
\end{description}


\begin{table}
\small{}
\begin{center}
\begin{tabular}{lrp{7cm}}
Nombre del campo        & Abr. & Description  \\ \hline
PrimaryAccessionNumber  & pa   & Primer número de acceso en ACCESSION \\
AccessionNumber         & an   & Números de acceso en ACCESSION \\
Division                & dv   & Division en LOCUS (ej. VRL=virus) \\
SequenceLength          & sl   & Longitud de secuencia en LOCUS \\
MolecularType           & mt   & Tipo de molecula in LOCUS (ej. RNA) \\
MolecularForm           & mf   & Estructura molecular (ej. linear) \\
Date                    & dt   & Última fecha de publicación en LOCUS  \\
Definition              & df   & Texto en DEFINITION \\
Comment                 & cm   & Texto en COMMENT \\
Keyword                 & kw   & Texto en KEYWORDS \\
Organism                & og   & Texto en el organismo de ORGANISM \\
Lineage                 & ln   & Texto en el linaje de ORGANISM \\
ReferenceAuthor         & ra   & Texto en AUTHORS de REFERENCE \\
ReferenceTitle          & rt   & Texto en TITLE de REFERENCE \\
ReferenceJournal        & rj   & Texto en JOURNAL de REFERENCE \\
ReferencePubmedID       & rp   & Texto en PUBMED de REFERENCE \\
Feature                 & fe   & Texto en FEATURES \\
\end{tabular}
\end{center}
\normalsize{}
\caption{Campos de búsqueda disponibles en DDBJ}
\label{tab:DDBJ_fields}
\end{table}

\begin{table}
\begin{center}
\small
\begin{tabular}{p{4cm}lp{8cm}}
Significado                             & Simbolo   & Ejemplo \\ \hline
Cualquier caracter individual           & .         & /ho.o/ coincide con 'homo' y con 'Rhodococcus'. \\
Cualquier caracter cero o más veces     & *         & /XX1*/ coincide con 'XX', 'XX1', 'XX11', etc \\
Cualquier caracter cero o una vez       & ?         & /XY?123/ coincide con 'XY123' and 'X123' \\
Cualquier caracter una o más veces      & +         & /XY1*/ coincide con 'XY1', 'XY11',etc, pero no con 'XY' \\
Cualquier caracter en un grupo          & [abc]     & /ho[dm]o/ coincide con 'homo' y con 'Rhodococcus', pero no con 'Achoropsyche' \\
Cualquier caracter excepto algunos      & [\^{}abc] & /ho[\^{}d]o/ coincide con 'homo'y con 'Achoropsyche', pero no con 'Rhodococcus' \\
Cualquier caracter en un rango          & [a-z0-9]  & /XY[1-9]00/ coincide con 'XY100', 'XY200', etc, 'XYA00', 'XYB00', etc \\
Cualquier caracter exactamente n vences & \{n\}     & /XY1{2}/ coincide con 'XY11' pero no con 'XY0' o 'XY000' \\
Cualquier caracter n o más veces        & \{n,\}    & /XY1{2,}/ coincide con 'XY11' y 'XY111', pero no con 'XY1' \\
Cualquier caracter n hasta m veces      & \{n,m\}   & /XY1{2,3}/ coincide con 'XY11' y con 'XY111', pero no con 'XY1' o 'XY1111' \\
\end{tabular}
\normalsize{}
\end{center}
\caption{tablecaption}
\label{tablelabel}
\end{table}

\subsubsection{WABI BLAST}
DDBJ ofrece una API web, e interface para hacer consultas con Java, perl y Ruby.
Sin embargo, la documentación solo está disponible en japonés, por ello lo 
dejaremos fuera de la discusión. Si se desea ver en detalle la documentación 
disponible, visite la página
'\url{http://www.ddbj.nig.ac.jp/search/help/wabi/wabi_blast_example-j.html}'.



% Las opciones de la búsqueda rápida son, en principio, similares a las de la 
% búsqueda rápida, sin embargo se permite un mayor flexibilidad para construir
% criterios de selección más complejos. Se permite hacer búsquedas con operadores
% de disyunción ('OR'), conjunción ('AND') y negación ('NOT') simultáneamente en 
% un mismo campo. También, se permite agrupar criterios entre paréntesis. En esta
% condición de búsqueda, el campo 'query' en la \textit{url} de la búsqueda ya no
% se utiliza, en cambio cada campo de búsqueda tiene uno que le corresponde en 
% la \textit{url} de búsqueda. Por ejemplo, la búsqueda rápida 
% '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=quick_search&query=df:homo&operator=AND}'
% se convierte en '\url{http://ddbj.nig.ac.jp/arsa/search?lang=en&cond=advanced_search&df=homo&op=AND}'.
% Por ejemplo la búsqueda
% '\url{http://ddbj.nig.ac.jp/arsa/search?lang=&cond=advanced_search&df=(virus+NOT+Junin)&ln=Arenaviridae&op=AND}'
% recupera los registros que en su linaje posea la palabra 'Arenaviridae' y que en
% la defición posea la palabra 'virus' y que no posea la palabra 'Junin'. Otro 
% ejemplo más, la búsqueda 
% '\url{http://ddbj.nig.ac.jp/arsa/search?lang=&cond=advanced_search&df=((virus+AND+Junin)+NOT+segment)&op=AND}'
% recupera los registros que poseen las palabras 'virus' y 'junín' en la definición 
% y que no contengan la palabra 'segment'.
% Otro ejemplo, la búsqueda 
% '\url{http://ddbj.nig.ac.jp/arsa/search?lang=&cond=advanced_search&df=((virus+AND+Junin)+OR+(virus+AND+Tacaribe))&op=AND}'
% recupera los que poseen los registros que contienen las palabras 'Junin' o 
% 'Tacaribe', pero no 'virus'.
% Todos los campos de búsqueda disponibles están en la tabla
% \ref{tab:DDBJ_fields}.  

 


% 
% 



\end{document}
